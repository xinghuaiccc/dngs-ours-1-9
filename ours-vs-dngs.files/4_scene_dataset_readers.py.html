<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>WinMerge File Compare Report</title>
<style>
<!--
table { table-layout: fixed; margin: 0; border: 1px solid #a0a0a0; box-shadow: 1px 1px 2px rgba(0, 0, 0, 0.15); }
th { position: sticky; top: 0; }
td,th { word-break: break-all; font-size: 10pt; padding: 0 3px; }
tr { vertical-align: top; }
.title { font-weight: bold; color: white; background-color: blue; vertical-align: top; text-align: center; padding: 4px 4px; background: linear-gradient(mediumblue, darkblue);}
.sf3b2 {color: #000000; background-color: #ffffff; }
.sf3b5 {color: #000000; background-color: #0078d7; }
.sf3b14 {color: #000000; background-color: #ffa0a0; }
.sf3b16 {color: #000000; background-color: #f1e2ad; }
.sf3b18 {color: #000000; background-color: #ffaa82; }
.sf3b19 {color: #000000; background-color: #c8816c; }
.sf6b2 {color: #ffffff; background-color: #ffffff; }
.sf6b5 {color: #ffffff; background-color: #0078d7; }
.sf6b14 {color: #ffffff; background-color: #ffa0a0; }
.sf6b16 {color: #ffffff; background-color: #f1e2ad; }
.sf6b18 {color: #ffffff; background-color: #ffaa82; }
.sf6b19 {color: #ffffff; background-color: #c8816c; }
.sf7b2 {color: #0000ff; background-color: #ffffff; font-weight: bold; }
.sf7b5 {color: #0000ff; background-color: #0078d7; font-weight: bold; }
.sf7b14 {color: #0000ff; background-color: #ffa0a0; font-weight: bold; }
.sf7b16 {color: #0000ff; background-color: #f1e2ad; font-weight: bold; }
.sf7b18 {color: #0000ff; background-color: #ffaa82; font-weight: bold; }
.sf7b19 {color: #0000ff; background-color: #c8816c; font-weight: bold; }
.sf8b2 {color: #800080; background-color: #ffffff; }
.sf8b5 {color: #800080; background-color: #0078d7; }
.sf8b14 {color: #800080; background-color: #ffa0a0; }
.sf8b16 {color: #800080; background-color: #f1e2ad; }
.sf8b18 {color: #800080; background-color: #ffaa82; }
.sf8b19 {color: #800080; background-color: #c8816c; }
.sf9b2 {color: #008000; background-color: #ffffff; }
.sf9b5 {color: #008000; background-color: #0078d7; }
.sf9b14 {color: #008000; background-color: #ffa0a0; }
.sf9b16 {color: #008000; background-color: #f1e2ad; }
.sf9b18 {color: #008000; background-color: #ffaa82; }
.sf9b19 {color: #008000; background-color: #c8816c; }
.sf10b2 {color: #ff0000; background-color: #ffffff; }
.sf10b5 {color: #ff0000; background-color: #0078d7; }
.sf10b14 {color: #ff0000; background-color: #ffa0a0; }
.sf10b16 {color: #ff0000; background-color: #f1e2ad; }
.sf10b18 {color: #ff0000; background-color: #ffaa82; }
.sf10b19 {color: #ff0000; background-color: #c8816c; }
.sf11b2 {color: #606060; background-color: #ffffff; }
.sf11b5 {color: #606060; background-color: #0078d7; }
.sf11b14 {color: #606060; background-color: #ffa0a0; }
.sf11b16 {color: #606060; background-color: #f1e2ad; }
.sf11b18 {color: #606060; background-color: #ffaa82; }
.sf11b19 {color: #606060; background-color: #c8816c; }
.sf12b2 {color: #800000; background-color: #ffffff; }
.sf12b5 {color: #800000; background-color: #0078d7; }
.sf12b14 {color: #800000; background-color: #ffa0a0; }
.sf12b16 {color: #800000; background-color: #f1e2ad; }
.sf12b18 {color: #800000; background-color: #ffaa82; }
.sf12b19 {color: #800000; background-color: #c8816c; }
.sf13b2 {color: #0080c0; background-color: #ffffff; }
.sf13b5 {color: #0080c0; background-color: #0078d7; }
.sf13b14 {color: #0080c0; background-color: #ffa0a0; }
.sf13b16 {color: #0080c0; background-color: #f1e2ad; }
.sf13b18 {color: #0080c0; background-color: #ffaa82; }
.sf13b19 {color: #0080c0; background-color: #c8816c; }
.sf15b2 {color: #000000; background-color: #ffffff; }
.sf15b5 {color: #000000; background-color: #0078d7; }
.sf15b14 {color: #000000; background-color: #ffa0a0; }
.sf15b16 {color: #000000; background-color: #f1e2ad; }
.sf15b18 {color: #000000; background-color: #ffaa82; }
.sf15b19 {color: #000000; background-color: #c8816c; }
.sf17b2 {color: #000000; background-color: #ffffff; }
.sf17b5 {color: #000000; background-color: #0078d7; }
.sf17b14 {color: #000000; background-color: #ffa0a0; }
.sf17b16 {color: #000000; background-color: #f1e2ad; }
.sf17b18 {color: #000000; background-color: #ffaa82; }
.sf17b19 {color: #000000; background-color: #c8816c; }
.sf20b2 {color: #000080; background-color: #ffffff; }
.sf20b5 {color: #000080; background-color: #0078d7; }
.sf20b14 {color: #000080; background-color: #ffa0a0; }
.sf20b16 {color: #000080; background-color: #f1e2ad; }
.sf20b18 {color: #000080; background-color: #ffaa82; }
.sf20b19 {color: #000080; background-color: #c8816c; }
.sf21b2 {color: #0080c0; background-color: #ffffff; }
.sf21b5 {color: #0080c0; background-color: #0078d7; }
.sf21b14 {color: #0080c0; background-color: #ffa0a0; }
.sf21b16 {color: #0080c0; background-color: #f1e2ad; }
.sf21b18 {color: #0080c0; background-color: #ffaa82; }
.sf21b19 {color: #0080c0; background-color: #c8816c; }
.sf3b2i {color: #ababab; background-color: #ffffff; }
.sf3b5i {color: #005190; background-color: #0078d7; }
.sf3b14i {color: #ab6b6b; background-color: #ffa0a0; }
.sf3b16i {color: #a19774; background-color: #f1e2ad; }
.sf3b18i {color: #ab7257; background-color: #ffaa82; }
.sf3b19i {color: #865749; background-color: #c8816c; }
.sf6b2i {color: #ffffff; background-color: #ffffff; }
.sf6b5i {color: #54a4e4; background-color: #0078d7; }
.sf6b14i {color: #ffbfbf; background-color: #ffa0a0; }
.sf6b16i {color: #f5ebc8; background-color: #f1e2ad; }
.sf6b18i {color: #ffc6ab; background-color: #ffaa82; }
.sf6b19i {color: #daaa9c; background-color: #c8816c; }
.sf7b2i {color: #ababff; background-color: #ffffff; font-weight: bold; }
.sf7b5i {color: #0051e4; background-color: #0078d7; font-weight: bold; }
.sf7b14i {color: #ab6bbf; background-color: #ffa0a0; font-weight: bold; }
.sf7b16i {color: #a197c8; background-color: #f1e2ad; font-weight: bold; }
.sf7b18i {color: #ab72ab; background-color: #ffaa82; font-weight: bold; }
.sf7b19i {color: #86579c; background-color: #c8816c; font-weight: bold; }
.sf8b2i {color: #d5abd5; background-color: #ffffff; }
.sf8b5i {color: #2a51bb; background-color: #0078d7; }
.sf8b14i {color: #d56b96; background-color: #ffa0a0; }
.sf8b16i {color: #cc979f; background-color: #f1e2ad; }
.sf8b18i {color: #d57282; background-color: #ffaa82; }
.sf8b19i {color: #b15772; background-color: #c8816c; }
.sf9b2i {color: #abd5ab; background-color: #ffffff; }
.sf9b5i {color: #007a90; background-color: #0078d7; }
.sf9b14i {color: #ab966b; background-color: #ffa0a0; }
.sf9b16i {color: #a1c274; background-color: #f1e2ad; }
.sf9b18i {color: #ab9d57; background-color: #ffaa82; }
.sf9b19i {color: #868149; background-color: #c8816c; }
.sf10b2i {color: #ffabab; background-color: #ffffff; }
.sf10b5i {color: #545190; background-color: #0078d7; }
.sf10b14i {color: #ff6b6b; background-color: #ffa0a0; }
.sf10b16i {color: #f59774; background-color: #f1e2ad; }
.sf10b18i {color: #ff7257; background-color: #ffaa82; }
.sf10b19i {color: #da5749; background-color: #c8816c; }
.sf11b2i {color: #cbcbcb; background-color: #ffffff; }
.sf11b5i {color: #1f71b0; background-color: #0078d7; }
.sf11b14i {color: #cb8b8b; background-color: #ffa0a0; }
.sf11b16i {color: #c1b794; background-color: #f1e2ad; }
.sf11b18i {color: #cb9277; background-color: #ffaa82; }
.sf11b19i {color: #a67769; background-color: #c8816c; }
.sf12b2i {color: #d5abab; background-color: #ffffff; }
.sf12b5i {color: #2a5190; background-color: #0078d7; }
.sf12b14i {color: #d56b6b; background-color: #ffa0a0; }
.sf12b16i {color: #cc9774; background-color: #f1e2ad; }
.sf12b18i {color: #d57257; background-color: #ffaa82; }
.sf12b19i {color: #b15749; background-color: #c8816c; }
.sf13b2i {color: #abd5eb; background-color: #ffffff; }
.sf13b5i {color: #007ad0; background-color: #0078d7; }
.sf13b14i {color: #ab96aa; background-color: #ffa0a0; }
.sf13b16i {color: #a1c2b3; background-color: #f1e2ad; }
.sf13b18i {color: #ab9d96; background-color: #ffaa82; }
.sf13b19i {color: #868187; background-color: #c8816c; }
.sf15b2i {color: #ababab; background-color: #ffffff; }
.sf15b5i {color: #005190; background-color: #0078d7; }
.sf15b14i {color: #ab6b6b; background-color: #ffa0a0; }
.sf15b16i {color: #a19774; background-color: #f1e2ad; }
.sf15b18i {color: #ab7257; background-color: #ffaa82; }
.sf15b19i {color: #865749; background-color: #c8816c; }
.sf17b2i {color: #ababab; background-color: #ffffff; }
.sf17b5i {color: #005190; background-color: #0078d7; }
.sf17b14i {color: #ab6b6b; background-color: #ffa0a0; }
.sf17b16i {color: #a19774; background-color: #f1e2ad; }
.sf17b18i {color: #ab7257; background-color: #ffaa82; }
.sf17b19i {color: #865749; background-color: #c8816c; }
.sf20b2i {color: #ababd5; background-color: #ffffff; }
.sf20b5i {color: #0051bb; background-color: #0078d7; }
.sf20b14i {color: #ab6b96; background-color: #ffa0a0; }
.sf20b16i {color: #a1979f; background-color: #f1e2ad; }
.sf20b18i {color: #ab7282; background-color: #ffaa82; }
.sf20b19i {color: #865772; background-color: #c8816c; }
.sf21b2i {color: #abd5eb; background-color: #ffffff; }
.sf21b5i {color: #007ad0; background-color: #0078d7; }
.sf21b14i {color: #ab96aa; background-color: #ffa0a0; }
.sf21b16i {color: #a1c2b3; background-color: #f1e2ad; }
.sf21b18i {color: #ab9d96; background-color: #ffaa82; }
.sf21b19i {color: #868187; background-color: #c8816c; }
.cn {text-align: center; word-break: normal; color: #000000; background-color: #f0f0f0;}
.ln {text-align: right; word-break: normal; color: #000000; background-color: #f0f0f0;}
-->
</style>
</head>
<body>
<table style="width: 100%; border-collapse: collapse;">
<colgroup>
<col style="width: 0.5em;" />
<col style="width: calc(100% / 2 - 0.5em);" />
<col style="width: 0.5em;" />
<col style="width: calc(100% / 2 - 0.5em);" />
</colgroup>
<thead>
<tr>
<th colspan="2" class="title">\\wsl.localhost\Ubuntu-20.04-C\root\DNGaussian\scene\dataset_readers.py</th>
<th colspan="2" class="title">\\wsl.localhost\Ubuntu-20.04-C\root\ours-sprse\scene\dataset_readers.py</th>
</tr>
</thead>
<tbody>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf9b2">#</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf9b2">#</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf9b2"># Copyright (C) 2023, Inria</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf9b2"># Copyright (C) 2023, Inria</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf9b2"># GRAPHDECO research group, https://team.inria.fr/graphdeco</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf9b2"># GRAPHDECO research group, https://team.inria.fr/graphdeco</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf9b2"># All rights reserved.</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf9b2"># All rights reserved.</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf9b2">#</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf9b2">#</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf9b2"># This software is free for non-commercial, research and evaluation use </span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf9b2"># This software is free for non-commercial, research and evaluation use </span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf9b2"># under the terms of the LICENSE.md file.</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf9b2"># under the terms of the LICENSE.md file.</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf9b2">#</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf9b2">#</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf9b2"># For inquiries contact &nbsp;george.drettakis@inria.fr</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf9b2"># For inquiries contact &nbsp;george.drettakis@inria.fr</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf9b2">#</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf9b2">#</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">os</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">os</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">sys</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">sys</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">from</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">PIL</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">Image</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">from</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">PIL</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">Image</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">from</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">typing</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">NamedTuple</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">from</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">typing</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">NamedTuple</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">from</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">scene</span><span class="sf11b2">.</span><span class="sf3b2">colmap_loader</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">read_extrinsics_text</span><span class="sf11b2">, </span><span class="sf3b2">read_intrinsics_text</span><span class="sf11b2">, </span><span class="sf3b2">qvec2rotmat</span><span class="sf11b2">, \</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">from</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">scene</span><span class="sf11b2">.</span><span class="sf3b2">colmap_loader</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">read_extrinsics_text</span><span class="sf11b2">, </span><span class="sf3b2">read_intrinsics_text</span><span class="sf11b2">, </span><span class="sf3b2">qvec2rotmat</span><span class="sf11b2">, \</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">read_extrinsics_binary</span><span class="sf11b2">, </span><span class="sf3b2">read_intrinsics_binary</span><span class="sf11b2">, </span><span class="sf3b2">read_points3D_binary</span><span class="sf11b2">, </span><span class="sf3b2">read_points3D_text</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">read_extrinsics_binary</span><span class="sf11b2">, </span><span class="sf3b2">read_intrinsics_binary</span><span class="sf11b2">, </span><span class="sf3b2">read_points3D_binary</span><span class="sf11b2">, </span><span class="sf3b2">read_points3D_text</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">from</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">utils</span><span class="sf11b2">.</span><span class="sf3b2">graphics_utils</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">getWorld2View2</span><span class="sf11b2">, </span><span class="sf3b2">focal2fov</span><span class="sf11b2">, </span><span class="sf3b2">fov2focal</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">from</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">utils</span><span class="sf11b2">.</span><span class="sf3b2">graphics_utils</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">getWorld2View2</span><span class="sf11b2">, </span><span class="sf3b2">focal2fov</span><span class="sf11b2">, </span><span class="sf3b2">fov2focal</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">numpy</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">as</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">np</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">numpy</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">as</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">np</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">json</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">json</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">from</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">pathlib</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">Path</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">from</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">pathlib</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">Path</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">from</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">plyfile</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">PlyData</span><span class="sf11b2">, </span><span class="sf3b2">PlyElement</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">from</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">plyfile</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">PlyData</span><span class="sf11b2">, </span><span class="sf3b2">PlyElement</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">from</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">utils</span><span class="sf11b2">.</span><span class="sf3b2">sh_utils</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">SH2RGB</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">from</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">utils</span><span class="sf11b2">.</span><span class="sf3b2">sh_utils</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">SH2RGB</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">from</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">scene</span><span class="sf11b2">.</span><span class="sf3b2">gaussian_model</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">BasicPointCloud</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">from</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">scene</span><span class="sf11b2">.</span><span class="sf3b2">gaussian_model</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">BasicPointCloud</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">torch</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">torch</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">class</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">CameraInfo</span><span class="sf11b2">(</span><span class="sf3b2">NamedTuple</span><span class="sf11b2">):</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">class</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">CameraInfo</span><span class="sf11b2">(</span><span class="sf3b2">NamedTuple</span><span class="sf11b2">):</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">uid</span><span class="sf11b2">: </span><span class="sf21b2">str</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">uid</span><span class="sf11b2">: </span><span class="sf21b2">str</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">R</span><span class="sf11b2">: </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">array</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">R</span><span class="sf11b2">: </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">array</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">T</span><span class="sf11b2">: </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">array</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">T</span><span class="sf11b2">: </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">array</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">FovY</span><span class="sf11b2">: </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">array</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">FovY</span><span class="sf11b2">: </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">array</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">FovX</span><span class="sf11b2">: </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">array</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">FovX</span><span class="sf11b2">: </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">array</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">image</span><span class="sf11b2">: </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">array</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">image</span><span class="sf11b2">: </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">array</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">image_path</span><span class="sf11b2">: </span><span class="sf21b2">str</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">image_path</span><span class="sf11b2">: </span><span class="sf21b2">str</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">image_name</span><span class="sf11b2">: </span><span class="sf21b2">str</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">image_name</span><span class="sf11b2">: </span><span class="sf21b2">str</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">width</span><span class="sf11b2">: </span><span class="sf21b2">int</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">width</span><span class="sf11b2">: </span><span class="sf21b2">int</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">height</span><span class="sf11b2">: </span><span class="sf21b2">int</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">height</span><span class="sf11b2">: </span><span class="sf21b2">int</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">depth_mono</span><span class="sf11b2">: </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">array</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">depth_mono</span><span class="sf11b2">: </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">array</span></code></td>
</tr>
<tr>
<td class="ln"><a id="d1" href="#d1">.</a></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; ">&nbsp; &nbsp; </span><span style="color: #000000; background-color: #efcb05; ">depth_anything_map</span><span style="color: #000000; background-color: #efcb05; ">: </span><span style="color: #000000; background-color: #efcb05; ">torch</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">Tensor</span><span style="color: #000000; background-color: #efcb05; ">&nbsp;= </span><span style="color: #000000; background-color: #efcb05; ">None</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">class</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">SceneInfo</span><span class="sf11b2">(</span><span class="sf3b2">NamedTuple</span><span class="sf11b2">):</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">class</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">SceneInfo</span><span class="sf11b2">(</span><span class="sf3b2">NamedTuple</span><span class="sf11b2">):</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">point_cloud</span><span class="sf11b2">: </span><span class="sf3b2">BasicPointCloud</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">point_cloud</span><span class="sf11b2">: </span><span class="sf3b2">BasicPointCloud</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">train_cameras</span><span class="sf11b2">: </span><span class="sf21b2">list</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">train_cameras</span><span class="sf11b2">: </span><span class="sf21b2">list</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">test_cameras</span><span class="sf11b2">: </span><span class="sf21b2">list</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">test_cameras</span><span class="sf11b2">: </span><span class="sf21b2">list</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">eval_cameras</span><span class="sf11b2">: </span><span class="sf21b2">list</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">eval_cameras</span><span class="sf11b2">: </span><span class="sf21b2">list</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">: </span><span class="sf21b2">dict</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">: </span><span class="sf21b2">dict</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">ply_path</span><span class="sf11b2">: </span><span class="sf21b2">str</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">ply_path</span><span class="sf11b2">: </span><span class="sf21b2">str</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">topk_</span><span class="sf11b2">(</span><span class="sf3b2">matrix</span><span class="sf11b2">, </span><span class="sf3b2">K</span><span class="sf11b2">, </span><span class="sf3b2">axis</span><span class="sf11b2">=</span><span class="sf10b2">1</span><span class="sf11b2">):</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">topk_</span><span class="sf11b2">(</span><span class="sf3b2">matrix</span><span class="sf11b2">, </span><span class="sf3b2">K</span><span class="sf11b2">, </span><span class="sf3b2">axis</span><span class="sf11b2">=</span><span class="sf10b2">1</span><span class="sf11b2">):</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">axis</span><span class="sf11b2">&nbsp;== </span><span class="sf10b2">0</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">axis</span><span class="sf11b2">&nbsp;== </span><span class="sf10b2">0</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">row_index</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">arange</span><span class="sf11b2">(</span><span class="sf3b2">matrix</span><span class="sf11b2">.</span><span class="sf3b2">shape</span><span class="sf11b2">[</span><span class="sf10b2">1</span><span class="sf11b2">&nbsp;- </span><span class="sf3b2">axis</span><span class="sf11b2">])</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">row_index</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">arange</span><span class="sf11b2">(</span><span class="sf3b2">matrix</span><span class="sf11b2">.</span><span class="sf3b2">shape</span><span class="sf11b2">[</span><span class="sf10b2">1</span><span class="sf11b2">&nbsp;- </span><span class="sf3b2">axis</span><span class="sf11b2">])</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">topk_index</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">argpartition</span><span class="sf11b2">(-</span><span class="sf3b2">matrix</span><span class="sf11b2">, </span><span class="sf3b2">K</span><span class="sf11b2">, </span><span class="sf3b2">axis</span><span class="sf11b2">=</span><span class="sf3b2">axis</span><span class="sf11b2">)[</span><span class="sf10b2">0</span><span class="sf11b2">:</span><span class="sf3b2">K</span><span class="sf11b2">, :]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">topk_index</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">argpartition</span><span class="sf11b2">(-</span><span class="sf3b2">matrix</span><span class="sf11b2">, </span><span class="sf3b2">K</span><span class="sf11b2">, </span><span class="sf3b2">axis</span><span class="sf11b2">=</span><span class="sf3b2">axis</span><span class="sf11b2">)[</span><span class="sf10b2">0</span><span class="sf11b2">:</span><span class="sf3b2">K</span><span class="sf11b2">, :]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">topk_data</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">matrix</span><span class="sf11b2">[</span><span class="sf3b2">topk_index</span><span class="sf11b2">, </span><span class="sf3b2">row_index</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">topk_data</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">matrix</span><span class="sf11b2">[</span><span class="sf3b2">topk_index</span><span class="sf11b2">, </span><span class="sf3b2">row_index</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">topk_index_sort</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">argsort</span><span class="sf11b2">(-</span><span class="sf3b2">topk_data</span><span class="sf11b2">,</span><span class="sf3b2">axis</span><span class="sf11b2">=</span><span class="sf3b2">axis</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">topk_index_sort</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">argsort</span><span class="sf11b2">(-</span><span class="sf3b2">topk_data</span><span class="sf11b2">,</span><span class="sf3b2">axis</span><span class="sf11b2">=</span><span class="sf3b2">axis</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">topk_data_sort</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">topk_data</span><span class="sf11b2">[</span><span class="sf3b2">topk_index_sort</span><span class="sf11b2">,</span><span class="sf3b2">row_index</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">topk_data_sort</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">topk_data</span><span class="sf11b2">[</span><span class="sf3b2">topk_index_sort</span><span class="sf11b2">,</span><span class="sf3b2">row_index</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">topk_index_sort</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">topk_index</span><span class="sf11b2">[</span><span class="sf10b2">0</span><span class="sf11b2">:</span><span class="sf3b2">K</span><span class="sf11b2">,:][</span><span class="sf3b2">topk_index_sort</span><span class="sf11b2">,</span><span class="sf3b2">row_i<wbr>ndex</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">topk_index_sort</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">topk_index</span><span class="sf11b2">[</span><span class="sf10b2">0</span><span class="sf11b2">:</span><span class="sf3b2">K</span><span class="sf11b2">,:][</span><span class="sf3b2">topk_index_sort</span><span class="sf11b2">,</span><span class="sf3b2">row_i<wbr>ndex</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">else</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">else</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">column_index</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">arange</span><span class="sf11b2">(</span><span class="sf3b2">matrix</span><span class="sf11b2">.</span><span class="sf3b2">shape</span><span class="sf11b2">[</span><span class="sf10b2">1</span><span class="sf11b2">&nbsp;- </span><span class="sf3b2">axis</span><span class="sf11b2">])[:, </span><span class="sf20b2">None</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">column_index</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">arange</span><span class="sf11b2">(</span><span class="sf3b2">matrix</span><span class="sf11b2">.</span><span class="sf3b2">shape</span><span class="sf11b2">[</span><span class="sf10b2">1</span><span class="sf11b2">&nbsp;- </span><span class="sf3b2">axis</span><span class="sf11b2">])[:, </span><span class="sf20b2">None</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">topk_index</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">argpartition</span><span class="sf11b2">(-</span><span class="sf3b2">matrix</span><span class="sf11b2">, </span><span class="sf3b2">K</span><span class="sf11b2">, </span><span class="sf3b2">axis</span><span class="sf11b2">=</span><span class="sf3b2">axis</span><span class="sf11b2">)[:, </span><span class="sf10b2">0</span><span class="sf11b2">:</span><span class="sf3b2">K</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">topk_index</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">argpartition</span><span class="sf11b2">(-</span><span class="sf3b2">matrix</span><span class="sf11b2">, </span><span class="sf3b2">K</span><span class="sf11b2">, </span><span class="sf3b2">axis</span><span class="sf11b2">=</span><span class="sf3b2">axis</span><span class="sf11b2">)[:, </span><span class="sf10b2">0</span><span class="sf11b2">:</span><span class="sf3b2">K</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">topk_data</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">matrix</span><span class="sf11b2">[</span><span class="sf3b2">column_index</span><span class="sf11b2">, </span><span class="sf3b2">topk_index</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">topk_data</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">matrix</span><span class="sf11b2">[</span><span class="sf3b2">column_index</span><span class="sf11b2">, </span><span class="sf3b2">topk_index</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">topk_index_sort</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">argsort</span><span class="sf11b2">(-</span><span class="sf3b2">topk_data</span><span class="sf11b2">, </span><span class="sf3b2">axis</span><span class="sf11b2">=</span><span class="sf3b2">axis</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">topk_index_sort</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">argsort</span><span class="sf11b2">(-</span><span class="sf3b2">topk_data</span><span class="sf11b2">, </span><span class="sf3b2">axis</span><span class="sf11b2">=</span><span class="sf3b2">axis</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">topk_data_sort</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">topk_data</span><span class="sf11b2">[</span><span class="sf3b2">column_index</span><span class="sf11b2">, </span><span class="sf3b2">topk_index_sort</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">topk_data_sort</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">topk_data</span><span class="sf11b2">[</span><span class="sf3b2">column_index</span><span class="sf11b2">, </span><span class="sf3b2">topk_index_sort</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">topk_index_sort</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">topk_index</span><span class="sf11b2">[:,</span><span class="sf10b2">0</span><span class="sf11b2">:</span><span class="sf3b2">K</span><span class="sf11b2">][</span><span class="sf3b2">column_index</span><span class="sf11b2">,</span><span class="sf3b2">topk_ind<wbr>ex_sort</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">topk_index_sort</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">topk_index</span><span class="sf11b2">[:,</span><span class="sf10b2">0</span><span class="sf11b2">:</span><span class="sf3b2">K</span><span class="sf11b2">][</span><span class="sf3b2">column_index</span><span class="sf11b2">,</span><span class="sf3b2">topk_ind<wbr>ex_sort</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">return</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">topk_data_sort</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">return</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">topk_data_sort</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">getNerfppNorm</span><span class="sf11b2">(</span><span class="sf3b2">cam_info</span><span class="sf11b2">):</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">getNerfppNorm</span><span class="sf11b2">(</span><span class="sf3b2">cam_info</span><span class="sf11b2">):</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">get_center_and_diag</span><span class="sf11b2">(</span><span class="sf3b2">cam_centers</span><span class="sf11b2">):</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">get_center_and_diag</span><span class="sf11b2">(</span><span class="sf3b2">cam_centers</span><span class="sf11b2">):</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_centers</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">hstack</span><span class="sf11b2">(</span><span class="sf3b2">cam_centers</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_centers</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">hstack</span><span class="sf11b2">(</span><span class="sf3b2">cam_centers</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">avg_cam_center</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">mean</span><span class="sf11b2">(</span><span class="sf3b2">cam_centers</span><span class="sf11b2">, </span><span class="sf3b2">axis</span><span class="sf11b2">=</span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf3b2">keepdims</span><span class="sf11b2">=</span><span class="sf20b2">True</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">avg_cam_center</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">mean</span><span class="sf11b2">(</span><span class="sf3b2">cam_centers</span><span class="sf11b2">, </span><span class="sf3b2">axis</span><span class="sf11b2">=</span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf3b2">keepdims</span><span class="sf11b2">=</span><span class="sf20b2">True</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">center</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">avg_cam_center</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">center</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">avg_cam_center</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">dist</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">linalg</span><span class="sf11b2">.</span><span class="sf8b2">norm</span><span class="sf11b2">(</span><span class="sf3b2">cam_centers</span><span class="sf11b2">&nbsp;- </span><span class="sf3b2">center</span><span class="sf11b2">, </span><span class="sf3b2">axis</span><span class="sf11b2">=</span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf3b2">keepdims</span><span class="sf11b2">=</span><span class="sf20b2">True</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">dist</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">linalg</span><span class="sf11b2">.</span><span class="sf8b2">norm</span><span class="sf11b2">(</span><span class="sf3b2">cam_centers</span><span class="sf11b2">&nbsp;- </span><span class="sf3b2">center</span><span class="sf11b2">, </span><span class="sf3b2">axis</span><span class="sf11b2">=</span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf3b2">keepdims</span><span class="sf11b2">=</span><span class="sf20b2">True</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">diagonal</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf21b2">max</span><span class="sf11b2">(</span><span class="sf3b2">dist</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">diagonal</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf21b2">max</span><span class="sf11b2">(</span><span class="sf3b2">dist</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">return</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">center</span><span class="sf11b2">.</span><span class="sf8b2">flatten</span><span class="sf11b2">(), </span><span class="sf3b2">diagonal</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">return</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">center</span><span class="sf11b2">.</span><span class="sf8b2">flatten</span><span class="sf11b2">(), </span><span class="sf3b2">diagonal</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">cam_centers</span><span class="sf11b2">&nbsp;= []</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">cam_centers</span><span class="sf11b2">&nbsp;= []</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">cam</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">cam_info</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">cam</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">cam_info</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">W2C</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">getWorld2View2</span><span class="sf11b2">(</span><span class="sf3b2">cam</span><span class="sf11b2">.</span><span class="sf3b2">R</span><span class="sf11b2">, </span><span class="sf3b2">cam</span><span class="sf11b2">.</span><span class="sf3b2">T</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">W2C</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">getWorld2View2</span><span class="sf11b2">(</span><span class="sf3b2">cam</span><span class="sf11b2">.</span><span class="sf3b2">R</span><span class="sf11b2">, </span><span class="sf3b2">cam</span><span class="sf11b2">.</span><span class="sf3b2">T</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">C2W</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">linalg</span><span class="sf11b2">.</span><span class="sf8b2">inv</span><span class="sf11b2">(</span><span class="sf3b2">W2C</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">C2W</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">linalg</span><span class="sf11b2">.</span><span class="sf8b2">inv</span><span class="sf11b2">(</span><span class="sf3b2">W2C</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_centers</span><span class="sf11b2">.</span><span class="sf8b2">append</span><span class="sf11b2">(</span><span class="sf3b2">C2W</span><span class="sf11b2">[:</span><span class="sf10b2">3</span><span class="sf11b2">, </span><span class="sf10b2">3</span><span class="sf11b2">:</span><span class="sf10b2">4</span><span class="sf11b2">])</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_centers</span><span class="sf11b2">.</span><span class="sf8b2">append</span><span class="sf11b2">(</span><span class="sf3b2">C2W</span><span class="sf11b2">[:</span><span class="sf10b2">3</span><span class="sf11b2">, </span><span class="sf10b2">3</span><span class="sf11b2">:</span><span class="sf10b2">4</span><span class="sf11b2">])</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">center</span><span class="sf11b2">, </span><span class="sf3b2">diagonal</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">get_center_and_diag</span><span class="sf11b2">(</span><span class="sf3b2">cam_centers</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">center</span><span class="sf11b2">, </span><span class="sf3b2">diagonal</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">get_center_and_diag</span><span class="sf11b2">(</span><span class="sf3b2">cam_centers</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">radius</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">diagonal</span><span class="sf11b2">&nbsp;* </span><span class="sf10b2">1.1</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">radius</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">diagonal</span><span class="sf11b2">&nbsp;* </span><span class="sf10b2">1.1</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">translate</span><span class="sf11b2">&nbsp;= -</span><span class="sf3b2">center</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">translate</span><span class="sf11b2">&nbsp;= -</span><span class="sf3b2">center</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">return</span><span class="sf11b2">&nbsp;{</span><span class="sf12b2">"translate"</span><span class="sf11b2">: </span><span class="sf3b2">translate</span><span class="sf11b2">, </span><span class="sf12b2">"radius"</span><span class="sf11b2">: </span><span class="sf3b2">radius</span><span class="sf11b2">}</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">return</span><span class="sf11b2">&nbsp;{</span><span class="sf12b2">"translate"</span><span class="sf11b2">: </span><span class="sf3b2">translate</span><span class="sf11b2">, </span><span class="sf12b2">"radius"</span><span class="sf11b2">: </span><span class="sf3b2">radius</span><span class="sf11b2">}</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">readColmapCameras</span><span class="sf11b2">(</span><span class="sf3b2">cam_extrinsics</span><span class="sf11b2">, </span><span class="sf3b2">cam_intrinsics</span><span class="sf11b2">, </span><span class="sf3b2">images_folder</span><span class="sf11b2">):</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">readColmapCameras</span><span class="sf11b2">(</span><span class="sf3b2">cam_extrinsics</span><span class="sf11b2">, </span><span class="sf3b2">cam_intrinsics</span><span class="sf11b2">, </span><span class="sf3b2">images_folder</span><span class="sf11b2">):</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">cam_infos</span><span class="sf11b2">&nbsp;= []</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">cam_infos</span><span class="sf11b2">&nbsp;= []</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">key</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">enumerate</span><span class="sf11b2">(</span><span class="sf3b2">cam_extrinsics</span><span class="sf11b2">):</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">key</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">enumerate</span><span class="sf11b2">(</span><span class="sf3b2">cam_extrinsics</span><span class="sf11b2">):</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">sys</span><span class="sf11b2">.</span><span class="sf20b2">stdout</span><span class="sf11b2">.</span><span class="sf8b2">write</span><span class="sf11b2">(</span><span class="sf12b2">'\r'</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">sys</span><span class="sf11b2">.</span><span class="sf20b2">stdout</span><span class="sf11b2">.</span><span class="sf8b2">write</span><span class="sf11b2">(</span><span class="sf12b2">'\r'</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># the exact output you're looking for:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># the exact output you're looking for:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">sys</span><span class="sf11b2">.</span><span class="sf20b2">stdout</span><span class="sf11b2">.</span><span class="sf8b2">write</span><span class="sf11b2">(</span><span class="sf12b2">"Reading camera {}/{}"</span><span class="sf11b2">.</span><span class="sf21b2">format</span><span class="sf11b2">(</span><span class="sf3b2">idx</span><span class="sf11b2">+</span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf21b2">len</span><span class="sf11b2">(</span><span class="sf3b2">cam_extrinsics</span><span class="sf11b2">)))</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">sys</span><span class="sf11b2">.</span><span class="sf20b2">stdout</span><span class="sf11b2">.</span><span class="sf8b2">write</span><span class="sf11b2">(</span><span class="sf12b2">"Reading camera {}/{}"</span><span class="sf11b2">.</span><span class="sf21b2">format</span><span class="sf11b2">(</span><span class="sf3b2">idx</span><span class="sf11b2">+</span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf21b2">len</span><span class="sf11b2">(</span><span class="sf3b2">cam_extrinsics</span><span class="sf11b2">)))</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">sys</span><span class="sf11b2">.</span><span class="sf20b2">stdout</span><span class="sf11b2">.</span><span class="sf8b2">flush</span><span class="sf11b2">()</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">sys</span><span class="sf11b2">.</span><span class="sf20b2">stdout</span><span class="sf11b2">.</span><span class="sf8b2">flush</span><span class="sf11b2">()</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">extr</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">cam_extrinsics</span><span class="sf11b2">[</span><span class="sf3b2">key</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">extr</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">cam_extrinsics</span><span class="sf11b2">[</span><span class="sf3b2">key</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">intr</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">cam_intrinsics</span><span class="sf11b2">[</span><span class="sf3b2">extr</span><span class="sf11b2">.</span><span class="sf3b2">camera_id</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">intr</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">cam_intrinsics</span><span class="sf11b2">[</span><span class="sf3b2">extr</span><span class="sf11b2">.</span><span class="sf3b2">camera_id</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">height</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">intr</span><span class="sf11b2">.</span><span class="sf3b2">height</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">height</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">intr</span><span class="sf11b2">.</span><span class="sf3b2">height</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">width</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">intr</span><span class="sf11b2">.</span><span class="sf3b2">width</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">width</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">intr</span><span class="sf11b2">.</span><span class="sf3b2">width</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">uid</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">intr</span><span class="sf11b2">.</span><span class="sf21b2">id</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">uid</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">intr</span><span class="sf11b2">.</span><span class="sf21b2">id</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">R</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">transpose</span><span class="sf11b2">(</span><span class="sf8b2">qvec2rotmat</span><span class="sf11b2">(</span><span class="sf3b2">extr</span><span class="sf11b2">.</span><span class="sf3b2">qvec</span><span class="sf11b2">))</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">R</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">transpose</span><span class="sf11b2">(</span><span class="sf8b2">qvec2rotmat</span><span class="sf11b2">(</span><span class="sf3b2">extr</span><span class="sf11b2">.</span><span class="sf3b2">qvec</span><span class="sf11b2">))</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">T</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">array</span><span class="sf11b2">(</span><span class="sf3b2">extr</span><span class="sf11b2">.</span><span class="sf3b2">tvec</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">T</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">array</span><span class="sf11b2">(</span><span class="sf3b2">extr</span><span class="sf11b2">.</span><span class="sf3b2">tvec</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">intr</span><span class="sf11b2">.</span><span class="sf3b2">model</span><span class="sf11b2">==</span><span class="sf12b2">"SIMPLE_PINHOLE"</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">or</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">intr</span><span class="sf11b2">.</span><span class="sf3b2">model</span><span class="sf11b2">==</span><span class="sf12b2">"SIMPLE_RADIAL"</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">intr</span><span class="sf11b2">.</span><span class="sf3b2">model</span><span class="sf11b2">==</span><span class="sf12b2">"SIMPLE_PINHOLE"</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">or</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">intr</span><span class="sf11b2">.</span><span class="sf3b2">model</span><span class="sf11b2">==</span><span class="sf12b2">"SIMPLE_RADIAL"</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">focal_length_x</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">intr</span><span class="sf11b2">.</span><span class="sf3b2">params</span><span class="sf11b2">[</span><span class="sf10b2">0</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">focal_length_x</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">intr</span><span class="sf11b2">.</span><span class="sf3b2">params</span><span class="sf11b2">[</span><span class="sf10b2">0</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">FovY</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">focal2fov</span><span class="sf11b2">(</span><span class="sf3b2">focal_length_x</span><span class="sf11b2">, </span><span class="sf3b2">height</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">FovY</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">focal2fov</span><span class="sf11b2">(</span><span class="sf3b2">focal_length_x</span><span class="sf11b2">, </span><span class="sf3b2">height</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">FovX</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">focal2fov</span><span class="sf11b2">(</span><span class="sf3b2">focal_length_x</span><span class="sf11b2">, </span><span class="sf3b2">width</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">FovX</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">focal2fov</span><span class="sf11b2">(</span><span class="sf3b2">focal_length_x</span><span class="sf11b2">, </span><span class="sf3b2">width</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">elif</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">intr</span><span class="sf11b2">.</span><span class="sf3b2">model</span><span class="sf11b2">==</span><span class="sf12b2">"PINHOLE"</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">elif</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">intr</span><span class="sf11b2">.</span><span class="sf3b2">model</span><span class="sf11b2">==</span><span class="sf12b2">"PINHOLE"</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">focal_length_x</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">intr</span><span class="sf11b2">.</span><span class="sf3b2">params</span><span class="sf11b2">[</span><span class="sf10b2">0</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">focal_length_x</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">intr</span><span class="sf11b2">.</span><span class="sf3b2">params</span><span class="sf11b2">[</span><span class="sf10b2">0</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">focal_length_y</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">intr</span><span class="sf11b2">.</span><span class="sf3b2">params</span><span class="sf11b2">[</span><span class="sf10b2">1</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">focal_length_y</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">intr</span><span class="sf11b2">.</span><span class="sf3b2">params</span><span class="sf11b2">[</span><span class="sf10b2">1</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">FovY</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">focal2fov</span><span class="sf11b2">(</span><span class="sf3b2">focal_length_y</span><span class="sf11b2">, </span><span class="sf3b2">height</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">FovY</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">focal2fov</span><span class="sf11b2">(</span><span class="sf3b2">focal_length_y</span><span class="sf11b2">, </span><span class="sf3b2">height</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">FovX</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">focal2fov</span><span class="sf11b2">(</span><span class="sf3b2">focal_length_x</span><span class="sf11b2">, </span><span class="sf3b2">width</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">FovX</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">focal2fov</span><span class="sf11b2">(</span><span class="sf3b2">focal_length_x</span><span class="sf11b2">, </span><span class="sf3b2">width</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">else</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">else</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">assert</span><span class="sf11b2">&nbsp;</span><span class="sf20b2">False</span><span class="sf11b2">, </span><span class="sf12b2">"Colmap camera model not handled: only undistorted datasets (PINHOLE or SIMPLE_PINHOLE cameras) supported but found {}!"</span><span class="sf11b2">.</span><span class="sf21b2">format</span><span class="sf11b2">(</span><span class="sf3b2">intr</span><span class="sf11b2">.</span><span class="sf3b2">model</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">assert</span><span class="sf11b2">&nbsp;</span><span class="sf20b2">False</span><span class="sf11b2">, </span><span class="sf12b2">"Colmap camera model not handled: only undistorted datasets (PINHOLE or SIMPLE_PINHOLE cameras) supported but found {}!"</span><span class="sf11b2">.</span><span class="sf21b2">format</span><span class="sf11b2">(</span><span class="sf3b2">intr</span><span class="sf11b2">.</span><span class="sf3b2">model</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">image_path</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf3b2">images_folder</span><span class="sf11b2">, </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">basename</span><span class="sf11b2">(</span><span class="sf3b2">extr</span><span class="sf11b2">.</span><span class="sf3b2">name</span><span class="sf11b2">))</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">image_path</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf3b2">images_folder</span><span class="sf11b2">, </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">basename</span><span class="sf11b2">(</span><span class="sf3b2">extr</span><span class="sf11b2">.</span><span class="sf3b2">name</span><span class="sf11b2">))</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">image_name</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">basename</span><span class="sf11b2">(</span><span class="sf3b2">image_path</span><span class="sf11b2">).</span><span class="sf8b2">split</span><span class="sf11b2">(</span><span class="sf12b2">"."</span><span class="sf11b2">)<wbr>[</span><span class="sf10b2">0</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">image_name</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">basename</span><span class="sf11b2">(</span><span class="sf3b2">image_path</span><span class="sf11b2">).</span><span class="sf8b2">split</span><span class="sf11b2">(</span><span class="sf12b2">"."</span><span class="sf11b2">)<wbr>[</span><span class="sf10b2">0</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">image</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">Image</span><span class="sf11b2">.</span><span class="sf21b2">open</span><span class="sf11b2">(</span><span class="sf3b2">image_path</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">image</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">Image</span><span class="sf11b2">.</span><span class="sf21b2">open</span><span class="sf11b2">(</span><span class="sf3b2">image_path</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># monocular depth</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># monocular depth</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2">## (fix path)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2">## (fix path)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">depth_mono_path</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf12b2">'/'</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf3b2">images_folder</span><span class="sf11b2">.</span><span class="sf8b2">spl<wbr>it</span><span class="sf11b2">(</span><span class="sf12b2">"/"</span><span class="sf11b2">)[:-</span><span class="sf10b2">1</span><span class="sf11b2">]), </span><span class="sf12b2">'depth_maps'</span><span class="sf11b2">, </span><span class="sf12b2">'depth_'</span><span class="sf11b2">&nbsp;+ </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">basename</span><span class="sf11b2">(</span><span class="sf3b2">extr</span><span class="sf11b2">.</span><span class="sf3b2">name</span><span class="sf11b2">).</span><span class="sf8b2">split</span><span class="sf11b2">(</span><span class="sf12b2">"."</span><span class="sf11b2">)[<wbr></span><span class="sf10b2">0</span><span class="sf11b2">] + </span><span class="sf12b2">'.png'</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">depth_mono_path</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf12b2">'/'</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf3b2">images_folder</span><span class="sf11b2">.</span><span class="sf8b2">spl<wbr>it</span><span class="sf11b2">(</span><span class="sf12b2">"/"</span><span class="sf11b2">)[:-</span><span class="sf10b2">1</span><span class="sf11b2">]), </span><span class="sf12b2">'depth_maps'</span><span class="sf11b2">, </span><span class="sf12b2">'depth_'</span><span class="sf11b2">&nbsp;+ </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">basename</span><span class="sf11b2">(</span><span class="sf3b2">extr</span><span class="sf11b2">.</span><span class="sf3b2">name</span><span class="sf11b2">).</span><span class="sf8b2">split</span><span class="sf11b2">(</span><span class="sf12b2">"."</span><span class="sf11b2">)[<wbr></span><span class="sf10b2">0</span><span class="sf11b2">] + </span><span class="sf12b2">'.png'</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">depth_mono</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">Image</span><span class="sf11b2">.</span><span class="sf21b2">open</span><span class="sf11b2">(</span><span class="sf3b2">depth_mono_path</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">depth_mono</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">Image</span><span class="sf11b2">.</span><span class="sf21b2">open</span><span class="sf11b2">(</span><span class="sf3b2">depth_mono_path</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_info</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">CameraInfo</span><span class="sf11b2">(</span><span class="sf3b2">uid</span><span class="sf11b2">=</span><span class="sf3b2">image_path</span><span class="sf11b2">, </span><span class="sf3b2">R</span><span class="sf11b2">=</span><span class="sf3b2">R</span><span class="sf11b2">, </span><span class="sf3b2">T</span><span class="sf11b2">=</span><span class="sf3b2">T</span><span class="sf11b2">, </span><span class="sf3b2">FovY</span><span class="sf11b2">=</span><span class="sf3b2">FovY</span><span class="sf11b2">, </span><span class="sf3b2">FovX</span><span class="sf11b2">=</span><span class="sf3b2">FovX</span><span class="sf11b2">, </span><span class="sf3b2">image</span><span class="sf11b2">=</span><span class="sf3b2">image</span><span class="sf11b2">, </span><span class="sf3b2">depth_mono</span><span class="sf11b2">=</span><span class="sf3b2">depth_mono</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_info</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">CameraInfo</span><span class="sf11b2">(</span><span class="sf3b2">uid</span><span class="sf11b2">=</span><span class="sf3b2">image_path</span><span class="sf11b2">, </span><span class="sf3b2">R</span><span class="sf11b2">=</span><span class="sf3b2">R</span><span class="sf11b2">, </span><span class="sf3b2">T</span><span class="sf11b2">=</span><span class="sf3b2">T</span><span class="sf11b2">, </span><span class="sf3b2">FovY</span><span class="sf11b2">=</span><span class="sf3b2">FovY</span><span class="sf11b2">, </span><span class="sf3b2">FovX</span><span class="sf11b2">=</span><span class="sf3b2">FovX</span><span class="sf11b2">, </span><span class="sf3b2">image</span><span class="sf11b2">=</span><span class="sf3b2">image</span><span class="sf11b2">, </span><span class="sf3b2">depth_mono</span><span class="sf11b2">=</span><span class="sf3b2">depth_mono</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"><a id="d2" href="#d2">.</a></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: #000000; background-color: #efcb05; ">image_path</span><span style="color: #000000; background-color: #efcb05; ">=</span><span style="color: #000000; background-color: #efcb05; ">image_path</span><span style="color: #000000; background-color: #efcb05; ">, </span><span style="color: #000000; background-color: #efcb05; ">image_name</span><span style="color: #000000; background-color: #efcb05; ">=</span><span style="color: #000000; background-color: #efcb05; ">image_name</span><span style="color: #000000; background-color: #efcb05; ">, </span><span style="color: #000000; background-color: #efcb05; ">width</span><span style="color: #000000; background-color: #efcb05; ">=</span><span style="color: #000000; background-color: #efcb05; ">width</span><span style="color: #000000; background-color: #efcb05; ">, </span><span style="color: #000000; background-color: #efcb05; ">height</span><span style="color: #000000; background-color: #efcb05; ">=</span><span style="color: #000000; background-color: #efcb05; ">height</span><span style="color: #000000; background-color: #efcb05; ">)</span></code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: #000000; background-color: #efcb05; ">image_path</span><span style="color: #000000; background-color: #efcb05; ">=</span><span style="color: #000000; background-color: #efcb05; ">image_path</span><span style="color: #000000; background-color: #efcb05; ">, </span><span style="color: #000000; background-color: #efcb05; ">image_name</span><span style="color: #000000; background-color: #efcb05; ">=</span><span style="color: #000000; background-color: #efcb05; ">image_name</span><span style="color: #000000; background-color: #efcb05; ">, </span><span style="color: #000000; background-color: #efcb05; ">width</span><span style="color: #000000; background-color: #efcb05; ">=</span><span style="color: #000000; background-color: #efcb05; ">width</span><span style="color: #000000; background-color: #efcb05; ">, </span><span style="color: #000000; background-color: #efcb05; ">height</span><span style="color: #000000; background-color: #efcb05; ">=</span><span style="color: #000000; background-color: #efcb05; ">height</span><span class="sf17b18">,</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; depth_anything_map=None</span><span style="color: #000000; background-color: #efcb05; ">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_infos</span><span class="sf11b2">.</span><span class="sf8b2">append</span><span class="sf11b2">(</span><span class="sf3b2">cam_info</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_infos</span><span class="sf11b2">.</span><span class="sf8b2">append</span><span class="sf11b2">(</span><span class="sf3b2">cam_info</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">sys</span><span class="sf11b2">.</span><span class="sf20b2">stdout</span><span class="sf11b2">.</span><span class="sf8b2">write</span><span class="sf11b2">(</span><span class="sf12b2">'\n'</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">sys</span><span class="sf11b2">.</span><span class="sf20b2">stdout</span><span class="sf11b2">.</span><span class="sf8b2">write</span><span class="sf11b2">(</span><span class="sf12b2">'\n'</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">return</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">cam_infos</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">return</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">cam_infos</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">fetchPly</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">):</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">fetchPly</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">):</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">plydata</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">PlyData</span><span class="sf11b2">.</span><span class="sf8b2">read</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">plydata</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">PlyData</span><span class="sf11b2">.</span><span class="sf8b2">read</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">vertices</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">plydata</span><span class="sf11b2">[</span><span class="sf12b2">'vertex'</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">vertices</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">plydata</span><span class="sf11b2">[</span><span class="sf12b2">'vertex'</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">positions</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">vstack</span><span class="sf11b2">([</span><span class="sf3b2">vertices</span><span class="sf11b2">[</span><span class="sf12b2">'x'</span><span class="sf11b2">], </span><span class="sf3b2">vertices</span><span class="sf11b2">[</span><span class="sf12b2">'y'</span><span class="sf11b2">], </span><span class="sf3b2">vertices</span><span class="sf11b2">[</span><span class="sf12b2">'z'</span><span class="sf11b2">]]).</span><span class="sf3b2">T</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">positions</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">vstack</span><span class="sf11b2">([</span><span class="sf3b2">vertices</span><span class="sf11b2">[</span><span class="sf12b2">'x'</span><span class="sf11b2">], </span><span class="sf3b2">vertices</span><span class="sf11b2">[</span><span class="sf12b2">'y'</span><span class="sf11b2">], </span><span class="sf3b2">vertices</span><span class="sf11b2">[</span><span class="sf12b2">'z'</span><span class="sf11b2">]]).</span><span class="sf3b2">T</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">colors</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">vstack</span><span class="sf11b2">([</span><span class="sf3b2">vertices</span><span class="sf11b2">[</span><span class="sf12b2">'red'</span><span class="sf11b2">], </span><span class="sf3b2">vertices</span><span class="sf11b2">[</span><span class="sf12b2">'green'</span><span class="sf11b2">], </span><span class="sf3b2">vertices</span><span class="sf11b2">[</span><span class="sf12b2">'blue'</span><span class="sf11b2">]]).</span><span class="sf3b2">T</span><span class="sf11b2">&nbsp;/ </span><span class="sf10b2">255.0</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">colors</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">vstack</span><span class="sf11b2">([</span><span class="sf3b2">vertices</span><span class="sf11b2">[</span><span class="sf12b2">'red'</span><span class="sf11b2">], </span><span class="sf3b2">vertices</span><span class="sf11b2">[</span><span class="sf12b2">'green'</span><span class="sf11b2">], </span><span class="sf3b2">vertices</span><span class="sf11b2">[</span><span class="sf12b2">'blue'</span><span class="sf11b2">]]).</span><span class="sf3b2">T</span><span class="sf11b2">&nbsp;/ </span><span class="sf10b2">255.0</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">normals</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">vstack</span><span class="sf11b2">([</span><span class="sf3b2">vertices</span><span class="sf11b2">[</span><span class="sf12b2">'nx'</span><span class="sf11b2">], </span><span class="sf3b2">vertices</span><span class="sf11b2">[</span><span class="sf12b2">'ny'</span><span class="sf11b2">], </span><span class="sf3b2">vertices</span><span class="sf11b2">[</span><span class="sf12b2">'nz'</span><span class="sf11b2">]]).</span><span class="sf3b2">T</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">normals</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">vstack</span><span class="sf11b2">([</span><span class="sf3b2">vertices</span><span class="sf11b2">[</span><span class="sf12b2">'nx'</span><span class="sf11b2">], </span><span class="sf3b2">vertices</span><span class="sf11b2">[</span><span class="sf12b2">'ny'</span><span class="sf11b2">], </span><span class="sf3b2">vertices</span><span class="sf11b2">[</span><span class="sf12b2">'nz'</span><span class="sf11b2">]]).</span><span class="sf3b2">T</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">return</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">BasicPointCloud</span><span class="sf11b2">(</span><span class="sf3b2">points</span><span class="sf11b2">=</span><span class="sf3b2">positions</span><span class="sf11b2">, </span><span class="sf3b2">colors</span><span class="sf11b2">=</span><span class="sf3b2">colors</span><span class="sf11b2">, </span><span class="sf3b2">normals</span><span class="sf11b2">=</span><span class="sf3b2">normals</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">return</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">BasicPointCloud</span><span class="sf11b2">(</span><span class="sf3b2">points</span><span class="sf11b2">=</span><span class="sf3b2">positions</span><span class="sf11b2">, </span><span class="sf3b2">colors</span><span class="sf11b2">=</span><span class="sf3b2">colors</span><span class="sf11b2">, </span><span class="sf3b2">normals</span><span class="sf11b2">=</span><span class="sf3b2">normals</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">storePly</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf3b2">rgb</span><span class="sf11b2">):</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">storePly</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf3b2">rgb</span><span class="sf11b2">):</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Define the dtype for the structured array</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Define the dtype for the structured array</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">dtype</span><span class="sf11b2">&nbsp;= [(</span><span class="sf12b2">'x'</span><span class="sf11b2">, </span><span class="sf12b2">'f4'</span><span class="sf11b2">), (</span><span class="sf12b2">'y'</span><span class="sf11b2">, </span><span class="sf12b2">'f4'</span><span class="sf11b2">), (</span><span class="sf12b2">'z'</span><span class="sf11b2">, </span><span class="sf12b2">'f4'</span><span class="sf11b2">),</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">dtype</span><span class="sf11b2">&nbsp;= [(</span><span class="sf12b2">'x'</span><span class="sf11b2">, </span><span class="sf12b2">'f4'</span><span class="sf11b2">), (</span><span class="sf12b2">'y'</span><span class="sf11b2">, </span><span class="sf12b2">'f4'</span><span class="sf11b2">), (</span><span class="sf12b2">'z'</span><span class="sf11b2">, </span><span class="sf12b2">'f4'</span><span class="sf11b2">),</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (</span><span class="sf12b2">'nx'</span><span class="sf11b2">, </span><span class="sf12b2">'f4'</span><span class="sf11b2">), (</span><span class="sf12b2">'ny'</span><span class="sf11b2">, </span><span class="sf12b2">'f4'</span><span class="sf11b2">), (</span><span class="sf12b2">'nz'</span><span class="sf11b2">, </span><span class="sf12b2">'f4'</span><span class="sf11b2">),</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (</span><span class="sf12b2">'nx'</span><span class="sf11b2">, </span><span class="sf12b2">'f4'</span><span class="sf11b2">), (</span><span class="sf12b2">'ny'</span><span class="sf11b2">, </span><span class="sf12b2">'f4'</span><span class="sf11b2">), (</span><span class="sf12b2">'nz'</span><span class="sf11b2">, </span><span class="sf12b2">'f4'</span><span class="sf11b2">),</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (</span><span class="sf12b2">'red'</span><span class="sf11b2">, </span><span class="sf12b2">'u1'</span><span class="sf11b2">), (</span><span class="sf12b2">'green'</span><span class="sf11b2">, </span><span class="sf12b2">'u1'</span><span class="sf11b2">), (</span><span class="sf12b2">'blue'</span><span class="sf11b2">, </span><span class="sf12b2">'u1'</span><span class="sf11b2">)]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (</span><span class="sf12b2">'red'</span><span class="sf11b2">, </span><span class="sf12b2">'u1'</span><span class="sf11b2">), (</span><span class="sf12b2">'green'</span><span class="sf11b2">, </span><span class="sf12b2">'u1'</span><span class="sf11b2">), (</span><span class="sf12b2">'blue'</span><span class="sf11b2">, </span><span class="sf12b2">'u1'</span><span class="sf11b2">)]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">normals</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">zeros_like</span><span class="sf11b2">(</span><span class="sf3b2">xyz</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">normals</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">zeros_like</span><span class="sf11b2">(</span><span class="sf3b2">xyz</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">elements</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">empty</span><span class="sf11b2">(</span><span class="sf3b2">xyz</span><span class="sf11b2">.</span><span class="sf3b2">shape</span><span class="sf11b2">[</span><span class="sf10b2">0</span><span class="sf11b2">], </span><span class="sf3b2">dtype</span><span class="sf11b2">=</span><span class="sf3b2">dtype</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">elements</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">empty</span><span class="sf11b2">(</span><span class="sf3b2">xyz</span><span class="sf11b2">.</span><span class="sf3b2">shape</span><span class="sf11b2">[</span><span class="sf10b2">0</span><span class="sf11b2">], </span><span class="sf3b2">dtype</span><span class="sf11b2">=</span><span class="sf3b2">dtype</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">attributes</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">concatenate</span><span class="sf11b2">((</span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf3b2">normals</span><span class="sf11b2">, </span><span class="sf3b2">rgb</span><span class="sf11b2">), </span><span class="sf3b2">axis</span><span class="sf11b2">=</span><span class="sf10b2">1</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">attributes</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">concatenate</span><span class="sf11b2">((</span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf3b2">normals</span><span class="sf11b2">, </span><span class="sf3b2">rgb</span><span class="sf11b2">), </span><span class="sf3b2">axis</span><span class="sf11b2">=</span><span class="sf10b2">1</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">elements</span><span class="sf11b2">[:] = </span><span class="sf21b2">list</span><span class="sf11b2">(</span><span class="sf21b2">map</span><span class="sf11b2">(</span><span class="sf21b2">tuple</span><span class="sf11b2">, </span><span class="sf3b2">attributes</span><span class="sf11b2">))</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">elements</span><span class="sf11b2">[:] = </span><span class="sf21b2">list</span><span class="sf11b2">(</span><span class="sf21b2">map</span><span class="sf11b2">(</span><span class="sf21b2">tuple</span><span class="sf11b2">, </span><span class="sf3b2">attributes</span><span class="sf11b2">))</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Create the PlyData object and write to file</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Create the PlyData object and write to file</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">vertex_element</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">PlyElement</span><span class="sf11b2">.</span><span class="sf8b2">describe</span><span class="sf11b2">(</span><span class="sf3b2">elements</span><span class="sf11b2">, </span><span class="sf12b2">'vertex'</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">vertex_element</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">PlyElement</span><span class="sf11b2">.</span><span class="sf8b2">describe</span><span class="sf11b2">(</span><span class="sf3b2">elements</span><span class="sf11b2">, </span><span class="sf12b2">'vertex'</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">ply_data</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">PlyData</span><span class="sf11b2">([</span><span class="sf3b2">vertex_element</span><span class="sf11b2">])</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">ply_data</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">PlyData</span><span class="sf11b2">([</span><span class="sf3b2">vertex_element</span><span class="sf11b2">])</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">ply_data</span><span class="sf11b2">.</span><span class="sf8b2">write</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">ply_data</span><span class="sf11b2">.</span><span class="sf8b2">write</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">readColmapSceneInfo</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf3b2">images</span><span class="sf11b2">, </span><span class="sf3b2">dataset</span><span class="sf11b2">, </span><span class="sf21b2">eval</span><span class="sf11b2">, </span><span class="sf3b2">rand_pcd</span><span class="sf11b2">, </span><span class="sf3b2">mvs_pcd</span><span class="sf11b2">, </span><span class="sf3b2">llffhold</span><span class="sf11b2">=</span><span class="sf10b2">8</span><span class="sf11b2">, </span><span class="sf3b2">N_sparse</span><span class="sf11b2">=-</span><span class="sf10b2">1</span><span class="sf11b2">):</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">readColmapSceneInfo</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf3b2">images</span><span class="sf11b2">, </span><span class="sf3b2">dataset</span><span class="sf11b2">, </span><span class="sf21b2">eval</span><span class="sf11b2">, </span><span class="sf3b2">rand_pcd</span><span class="sf11b2">, </span><span class="sf3b2">mvs_pcd</span><span class="sf11b2">, </span><span class="sf3b2">llffhold</span><span class="sf11b2">=</span><span class="sf10b2">8</span><span class="sf11b2">, </span><span class="sf3b2">N_sparse</span><span class="sf11b2">=-</span><span class="sf10b2">1</span><span class="sf11b2">):</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">try</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">try</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cameras_extrinsic_file</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"sparse/0"</span><span class="sf11b2">, </span><span class="sf12b2">"images.bin"</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cameras_extrinsic_file</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"sparse/0"</span><span class="sf11b2">, </span><span class="sf12b2">"images.bin"</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cameras_intrinsic_file</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"sparse/0"</span><span class="sf11b2">, </span><span class="sf12b2">"cameras.bin"</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cameras_intrinsic_file</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"sparse/0"</span><span class="sf11b2">, </span><span class="sf12b2">"cameras.bin"</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_extrinsics</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">read_extrinsics_binary</span><span class="sf11b2">(</span><span class="sf3b2">cameras_extrinsi<wbr>c_file</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_extrinsics</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">read_extrinsics_binary</span><span class="sf11b2">(</span><span class="sf3b2">cameras_extrinsi<wbr>c_file</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_intrinsics</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">read_intrinsics_binary</span><span class="sf11b2">(</span><span class="sf3b2">cameras_intrinsi<wbr>c_file</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_intrinsics</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">read_intrinsics_binary</span><span class="sf11b2">(</span><span class="sf3b2">cameras_intrinsi<wbr>c_file</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">except</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">except</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cameras_extrinsic_file</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"sparse/0"</span><span class="sf11b2">, </span><span class="sf12b2">"images.txt"</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cameras_extrinsic_file</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"sparse/0"</span><span class="sf11b2">, </span><span class="sf12b2">"images.txt"</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cameras_intrinsic_file</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"sparse/0"</span><span class="sf11b2">, </span><span class="sf12b2">"cameras.txt"</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cameras_intrinsic_file</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"sparse/0"</span><span class="sf11b2">, </span><span class="sf12b2">"cameras.txt"</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_extrinsics</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">read_extrinsics_text</span><span class="sf11b2">(</span><span class="sf3b2">cameras_extrinsic_<wbr>file</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_extrinsics</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">read_extrinsics_text</span><span class="sf11b2">(</span><span class="sf3b2">cameras_extrinsic_<wbr>file</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_intrinsics</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">read_intrinsics_text</span><span class="sf11b2">(</span><span class="sf3b2">cameras_intrinsic_<wbr>file</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_intrinsics</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">read_intrinsics_text</span><span class="sf11b2">(</span><span class="sf3b2">cameras_intrinsic_<wbr>file</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># print(cam_intrinsics)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># print(cam_intrinsics)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">reading_dir</span><span class="sf11b2">&nbsp;= </span><span class="sf12b2">"images"</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">images</span><span class="sf11b2">&nbsp;== </span><span class="sf20b2">None</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">else</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">images</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">reading_dir</span><span class="sf11b2">&nbsp;= </span><span class="sf12b2">"images"</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">images</span><span class="sf11b2">&nbsp;== </span><span class="sf20b2">None</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">else</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">images</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">cam_infos_unsorted</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">readColmapCameras</span><span class="sf11b2">(</span><span class="sf3b2">cam_extrinsics</span><span class="sf11b2">=</span><span class="sf3b2">cam_ex<wbr>trinsics</span><span class="sf11b2">, </span><span class="sf3b2">cam_intrinsics</span><span class="sf11b2">=</span><span class="sf3b2">cam_intrinsics</span><span class="sf11b2">, </span><span class="sf3b2">images_folder</span><span class="sf11b2">=</span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf3b2">reading_dir</span><span class="sf11b2">))</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">cam_infos_unsorted</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">readColmapCameras</span><span class="sf11b2">(</span><span class="sf3b2">cam_extrinsics</span><span class="sf11b2">=</span><span class="sf3b2">cam_ex<wbr>trinsics</span><span class="sf11b2">, </span><span class="sf3b2">cam_intrinsics</span><span class="sf11b2">=</span><span class="sf3b2">cam_intrinsics</span><span class="sf11b2">, </span><span class="sf3b2">images_folder</span><span class="sf11b2">=</span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf3b2">reading_dir</span><span class="sf11b2">))</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">cam_infos</span><span class="sf11b2">&nbsp;= </span><span class="sf21b2">sorted</span><span class="sf11b2">(</span><span class="sf3b2">cam_infos_unsorted</span><span class="sf11b2">.</span><span class="sf8b2">copy</span><span class="sf11b2">(), </span><span class="sf3b2">key</span><span class="sf11b2">&nbsp;= </span><span class="sf7b2">lambda</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">x</span><span class="sf11b2">&nbsp;: </span><span class="sf3b2">x</span><span class="sf11b2">.</span><span class="sf3b2">image_name</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">cam_infos</span><span class="sf11b2">&nbsp;= </span><span class="sf21b2">sorted</span><span class="sf11b2">(</span><span class="sf3b2">cam_infos_unsorted</span><span class="sf11b2">.</span><span class="sf8b2">copy</span><span class="sf11b2">(), </span><span class="sf3b2">key</span><span class="sf11b2">&nbsp;= </span><span class="sf7b2">lambda</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">x</span><span class="sf11b2">&nbsp;: </span><span class="sf3b2">x</span><span class="sf11b2">.</span><span class="sf3b2">image_name</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"><a id="d3" href="#d3">.</a></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; ">&nbsp; &nbsp; </span><span style="color: #000000; background-color: #efcb05; ">cam_infos_with_depth</span><span style="color: #000000; background-color: #efcb05; ">&nbsp;= []</span></code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; ">&nbsp; &nbsp; </span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">for</span><span style="color: #000000; background-color: #efcb05; ">&nbsp;</span><span style="color: #000000; background-color: #efcb05; ">cam_info</span><span style="color: #000000; background-color: #efcb05; ">&nbsp;</span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">in</span><span style="color: #000000; background-color: #efcb05; ">&nbsp;</span><span style="color: #000000; background-color: #efcb05; ">cam_infos</span><span style="color: #000000; background-color: #efcb05; ">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; ">&nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: #000000; background-color: #efcb05; ">depth_anything_map</span><span style="color: #000000; background-color: #efcb05; ">&nbsp;= </span><span style="color: #000000; background-color: #efcb05; ">None</span></code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; ">&nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: #000000; background-color: #efcb05; ">depths_dir</span><span style="color: #000000; background-color: #efcb05; ">&nbsp;= </span><span style="color: #000000; background-color: #efcb05; ">os</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">path</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">join</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">os</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">path</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">dirname</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">os</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">path</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">di<wbr>rname</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">cam_info</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">image_path</span><span style="color: #000000; background-color: #efcb05; ">)), </span><span style="color: #000000; background-color: #efcb05; ">"depths_npy"</span><span style="color: #000000; background-color: #efcb05; ">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; ">&nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: #000000; background-color: #efcb05; ">depth_anything_path</span><span style="color: #000000; background-color: #efcb05; ">&nbsp;= </span><span style="color: #000000; background-color: #efcb05; ">os</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">path</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">join</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">depths_dir</span><span style="color: #000000; background-color: #efcb05; ">, </span><span style="color: #000000; background-color: #efcb05; ">cam_info</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">image_name</span><span style="color: #000000; background-color: #efcb05; ">&nbsp;+ </span><span style="color: #000000; background-color: #efcb05; ">".npy"</span><span style="color: #000000; background-color: #efcb05; ">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; ">&nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">if</span><span style="color: #000000; background-color: #efcb05; ">&nbsp;</span><span style="color: #000000; background-color: #efcb05; ">os</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">path</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">exists</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">depth_anything_path</span><span style="color: #000000; background-color: #efcb05; ">):</span></code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; ">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: #000000; background-color: #efcb05; ">depth_anything_map</span><span style="color: #000000; background-color: #efcb05; ">&nbsp;= </span><span style="color: #000000; background-color: #efcb05; ">torch</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">from_numpy</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">np</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">load</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">depth_anything<wbr>_path</span><span style="color: #000000; background-color: #efcb05; ">))</span></code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; ">&nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: #000000; background-color: #efcb05; ">cam_infos_with_depth</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">append</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">cam_info</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">_r<wbr>eplace</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">depth_anything_map</span><span style="color: #000000; background-color: #efcb05; ">=</span><span style="color: #000000; background-color: #efcb05; ">depth_anythin<wbr>g_map</span><span style="color: #000000; background-color: #efcb05; ">))</span></code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; ">&nbsp; &nbsp; </span><span style="color: #000000; background-color: #efcb05; ">cam_infos</span><span style="color: #000000; background-color: #efcb05; ">&nbsp;= </span><span style="color: #000000; background-color: #efcb05; ">cam_infos_with_depth</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">eval</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">eval</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf12b2">"Dataset Type: "</span><span class="sf11b2">, </span><span class="sf3b2">dataset</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf12b2">"Dataset Type: "</span><span class="sf11b2">, </span><span class="sf3b2">dataset</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">dataset</span><span class="sf11b2">&nbsp;== </span><span class="sf12b2">"LLFF"</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">dataset</span><span class="sf11b2">&nbsp;== </span><span class="sf12b2">"LLFF"</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">&nbsp;= [</span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">enumerate</span><span class="sf11b2">(</span><span class="sf3b2">cam_infos</span><span class="sf11b2">) </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">&nbsp;% </span><span class="sf3b2">llffhold</span><span class="sf11b2">&nbsp;!= </span><span class="sf10b2">0</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">&nbsp;= [</span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">enumerate</span><span class="sf11b2">(</span><span class="sf3b2">cam_infos</span><span class="sf11b2">) </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">&nbsp;% </span><span class="sf3b2">llffhold</span><span class="sf11b2">&nbsp;!= </span><span class="sf10b2">0</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">eval_cam_infos</span><span class="sf11b2">&nbsp;= [</span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">enumerate</span><span class="sf11b2">(</span><span class="sf3b2">cam_infos</span><span class="sf11b2">) </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">&nbsp;% </span><span class="sf3b2">llffhold</span><span class="sf11b2">&nbsp;== </span><span class="sf10b2">0</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">eval_cam_infos</span><span class="sf11b2">&nbsp;= [</span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">enumerate</span><span class="sf11b2">(</span><span class="sf3b2">cam_infos</span><span class="sf11b2">) </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">&nbsp;% </span><span class="sf3b2">llffhold</span><span class="sf11b2">&nbsp;== </span><span class="sf10b2">0</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">N_sparse</span><span class="sf11b2">&nbsp;&gt; </span><span class="sf10b2">0</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">N_sparse</span><span class="sf11b2">&nbsp;&gt; </span><span class="sf10b2">0</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">idx</span><span class="sf11b2">&nbsp;= </span><span class="sf21b2">list</span><span class="sf11b2">(</span><span class="sf21b2">range</span><span class="sf11b2">(</span><span class="sf21b2">len</span><span class="sf11b2">(</span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">)))</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">idx</span><span class="sf11b2">&nbsp;= </span><span class="sf21b2">list</span><span class="sf11b2">(</span><span class="sf21b2">range</span><span class="sf11b2">(</span><span class="sf21b2">len</span><span class="sf11b2">(</span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">)))</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">idx_train</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">linspace</span><span class="sf11b2">(</span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf21b2">len</span><span class="sf11b2">(</span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">) - </span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf3b2">N_sparse</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">idx_train</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">linspace</span><span class="sf11b2">(</span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf21b2">len</span><span class="sf11b2">(</span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">) - </span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf3b2">N_sparse</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">idx_train</span><span class="sf11b2">&nbsp;= [</span><span class="sf21b2">round</span><span class="sf11b2">(</span><span class="sf3b2">i</span><span class="sf11b2">) </span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">i</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx_train</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">idx_train</span><span class="sf11b2">&nbsp;= [</span><span class="sf21b2">round</span><span class="sf11b2">(</span><span class="sf3b2">i</span><span class="sf11b2">) </span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">i</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx_train</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">idx_test</span><span class="sf11b2">&nbsp;= [</span><span class="sf3b2">i</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">i</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">i</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">not</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx_train</span><span class="sf11b2">] </span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">idx_test</span><span class="sf11b2">&nbsp;= [</span><span class="sf3b2">i</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">i</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">i</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">not</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx_train</span><span class="sf11b2">] </span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">&nbsp;= [</span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">enumerate</span><span class="sf11b2">(</span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">) </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx_train</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">&nbsp;= [</span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">enumerate</span><span class="sf11b2">(</span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">) </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx_train</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">test_cam_infos</span><span class="sf11b2">&nbsp;= [</span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">enumerate</span><span class="sf11b2">(</span><span class="sf3b2">cam_infos</span><span class="sf11b2">) </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx_test</span><span class="sf11b2">] + </span><span class="sf3b2">eval_cam_infos</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">test_cam_infos</span><span class="sf11b2">&nbsp;= [</span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">enumerate</span><span class="sf11b2">(</span><span class="sf3b2">cam_infos</span><span class="sf11b2">) </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx_test</span><span class="sf11b2">] + </span><span class="sf3b2">eval_cam_infos</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># print('train', idx_train)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># print('train', idx_train)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># print('test', train_cam_infos)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># print('test', train_cam_infos)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># else:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># else:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># &nbsp; &nbsp; train_cam_infos = [c for idx, c in enumerate(cam_infos) if idx % llffhold != 0]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># &nbsp; &nbsp; train_cam_infos = [c for idx, c in enumerate(cam_infos) if idx % llffhold != 0]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># &nbsp; &nbsp; test_cam_infos = [c for idx, c in enumerate(cam_infos) if idx % llffhold == 0]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># &nbsp; &nbsp; test_cam_infos = [c for idx, c in enumerate(cam_infos) if idx % llffhold == 0]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">elif</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">dataset</span><span class="sf11b2">&nbsp;== </span><span class="sf12b2">"DTU"</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">elif</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">dataset</span><span class="sf11b2">&nbsp;== </span><span class="sf12b2">"DTU"</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">train_idx</span><span class="sf11b2">&nbsp;= [</span><span class="sf10b2">25</span><span class="sf11b2">, </span><span class="sf10b2">22</span><span class="sf11b2">, </span><span class="sf10b2">28</span><span class="sf11b2">, </span><span class="sf10b2">40</span><span class="sf11b2">, </span><span class="sf10b2">44</span><span class="sf11b2">, </span><span class="sf10b2">48</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">8</span><span class="sf11b2">, </span><span class="sf10b2">13</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">train_idx</span><span class="sf11b2">&nbsp;= [</span><span class="sf10b2">25</span><span class="sf11b2">, </span><span class="sf10b2">22</span><span class="sf11b2">, </span><span class="sf10b2">28</span><span class="sf11b2">, </span><span class="sf10b2">40</span><span class="sf11b2">, </span><span class="sf10b2">44</span><span class="sf11b2">, </span><span class="sf10b2">48</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">8</span><span class="sf11b2">, </span><span class="sf10b2">13</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">exclude_idx</span><span class="sf11b2">&nbsp;= [</span><span class="sf10b2">3</span><span class="sf11b2">, </span><span class="sf10b2">4</span><span class="sf11b2">, </span><span class="sf10b2">5</span><span class="sf11b2">, </span><span class="sf10b2">6</span><span class="sf11b2">, </span><span class="sf10b2">7</span><span class="sf11b2">, </span><span class="sf10b2">16</span><span class="sf11b2">, </span><span class="sf10b2">17</span><span class="sf11b2">, </span><span class="sf10b2">18</span><span class="sf11b2">, </span><span class="sf10b2">19</span><span class="sf11b2">, </span><span class="sf10b2">20</span><span class="sf11b2">, </span><span class="sf10b2">21</span><span class="sf11b2">, </span><span class="sf10b2">36</span><span class="sf11b2">, </span><span class="sf10b2">37</span><span class="sf11b2">, </span><span class="sf10b2">38</span><span class="sf11b2">, </span><span class="sf10b2">39</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">exclude_idx</span><span class="sf11b2">&nbsp;= [</span><span class="sf10b2">3</span><span class="sf11b2">, </span><span class="sf10b2">4</span><span class="sf11b2">, </span><span class="sf10b2">5</span><span class="sf11b2">, </span><span class="sf10b2">6</span><span class="sf11b2">, </span><span class="sf10b2">7</span><span class="sf11b2">, </span><span class="sf10b2">16</span><span class="sf11b2">, </span><span class="sf10b2">17</span><span class="sf11b2">, </span><span class="sf10b2">18</span><span class="sf11b2">, </span><span class="sf10b2">19</span><span class="sf11b2">, </span><span class="sf10b2">20</span><span class="sf11b2">, </span><span class="sf10b2">21</span><span class="sf11b2">, </span><span class="sf10b2">36</span><span class="sf11b2">, </span><span class="sf10b2">37</span><span class="sf11b2">, </span><span class="sf10b2">38</span><span class="sf11b2">, </span><span class="sf10b2">39</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">test_idx</span><span class="sf11b2">&nbsp;= [</span><span class="sf3b2">i</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">i</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">arange</span><span class="sf11b2">(</span><span class="sf10b2">49</span><span class="sf11b2">) </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">i</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">not</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">train_idx</span><span class="sf11b2">&nbsp;+ </span><span class="sf3b2">exclude_idx</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">test_idx</span><span class="sf11b2">&nbsp;= [</span><span class="sf3b2">i</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">i</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">arange</span><span class="sf11b2">(</span><span class="sf10b2">49</span><span class="sf11b2">) </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">i</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">not</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">train_idx</span><span class="sf11b2">&nbsp;+ </span><span class="sf3b2">exclude_idx</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">N_sparse</span><span class="sf11b2">&nbsp;&gt; </span><span class="sf10b2">0</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">N_sparse</span><span class="sf11b2">&nbsp;&gt; </span><span class="sf10b2">0</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">train_idx</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">train_idx</span><span class="sf11b2">[:</span><span class="sf3b2">N_sparse</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">train_idx</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">train_idx</span><span class="sf11b2">[:</span><span class="sf3b2">N_sparse</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">&nbsp;= [</span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">enumerate</span><span class="sf11b2">(</span><span class="sf3b2">cam_infos</span><span class="sf11b2">) </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">train_idx</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">&nbsp;= [</span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">enumerate</span><span class="sf11b2">(</span><span class="sf3b2">cam_infos</span><span class="sf11b2">) </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">train_idx</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">test_cam_infos</span><span class="sf11b2">&nbsp;= [</span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">enumerate</span><span class="sf11b2">(</span><span class="sf3b2">cam_infos</span><span class="sf11b2">) </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">test_idx</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">test_cam_infos</span><span class="sf11b2">&nbsp;= [</span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">enumerate</span><span class="sf11b2">(</span><span class="sf3b2">cam_infos</span><span class="sf11b2">) </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">test_idx</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">eval_cam_infos</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">test_cam_infos</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">eval_cam_infos</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">test_cam_infos</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">else</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">else</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">raise</span><span class="sf11b2">&nbsp;</span><span class="sf20b2">NotImplementedError</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">raise</span><span class="sf11b2">&nbsp;</span><span class="sf20b2">NotImplementedError</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">else</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">else</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">cam_infos</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">cam_infos</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">test_cam_infos</span><span class="sf11b2">&nbsp;= []</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">test_cam_infos</span><span class="sf11b2">&nbsp;= []</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">eval_cam_infos</span><span class="sf11b2">&nbsp;= []</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">eval_cam_infos</span><span class="sf11b2">&nbsp;= []</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf12b2">'train'</span><span class="sf11b2">, [</span><span class="sf3b2">info</span><span class="sf11b2">.</span><span class="sf3b2">image_path</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">info</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">])</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf12b2">'train'</span><span class="sf11b2">, [</span><span class="sf3b2">info</span><span class="sf11b2">.</span><span class="sf3b2">image_path</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">info</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">])</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf12b2">'eval'</span><span class="sf11b2">, [</span><span class="sf3b2">info</span><span class="sf11b2">.</span><span class="sf3b2">image_path</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">info</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">eval_cam_infos</span><span class="sf11b2">])</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf12b2">'eval'</span><span class="sf11b2">, [</span><span class="sf3b2">info</span><span class="sf11b2">.</span><span class="sf3b2">image_path</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">info</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">eval_cam_infos</span><span class="sf11b2">])</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">getNerfppNorm</span><span class="sf11b2">(</span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">getNerfppNorm</span><span class="sf11b2">(</span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">rand_pcd</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">and</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">mvs_pcd</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">rand_pcd</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">and</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">mvs_pcd</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf12b2">"[warning] Both --rand_pcd and --mvs_pcd are detected, use --mvs_pcd."</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf12b2">"[warning] Both --rand_pcd and --mvs_pcd are detected, use --mvs_pcd."</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">rand_pcd</span><span class="sf11b2">&nbsp;= </span><span class="sf20b2">False</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">rand_pcd</span><span class="sf11b2">&nbsp;= </span><span class="sf20b2">False</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"><a id="d4" href="#d4">.</a></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; ">&nbsp; &nbsp; </span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">if</span><span style="color: #000000; background-color: #efcb05; ">&nbsp;</span><span style="color: #000000; background-color: #efcb05; ">rand_pcd</span><span style="color: #000000; background-color: #efcb05; ">:</span></code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; ">&nbsp; &nbsp; </span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">if</span><span style="color: #000000; background-color: #efcb05; ">&nbsp;</span><span class="sf17b18">mvs_pcd:</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18">&nbsp; &nbsp; &nbsp; &nbsp; # Use fused point cloud from 3 views as initialized points.</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18">&nbsp; &nbsp; &nbsp; &nbsp; ply_path = os.path.join(path, "3_views/dense/fused.ply")</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18">&nbsp; &nbsp; &nbsp; &nbsp; print(f"Init MVS point cloud from: {ply_path}")</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18">&nbsp; &nbsp; &nbsp; &nbsp; assert os.path.exists(ply_path)</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18">&nbsp; &nbsp; &nbsp; &nbsp; pcd = fetchPly(ply_path)</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18">&nbsp; &nbsp; elif </span><span style="color: #000000; background-color: #efcb05; ">rand_pcd</span><span style="color: #000000; background-color: #efcb05; ">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf12b2">'Init random point cloud.'</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf12b2">'Init random point cloud.'</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">ply_path</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"sparse/0/points3D_random.ply"</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">ply_path</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"sparse/0/points3D_random.ply"</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">bin_path</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"sparse/0/points3D.bin"</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">bin_path</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"sparse/0/points3D.bin"</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">txt_path</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"sparse/0/points3D.txt"</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">txt_path</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"sparse/0/points3D.txt"</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">try</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">try</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf3b2">rgb</span><span class="sf11b2">, </span><span class="sf3b2">_</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">read_points3D_binary</span><span class="sf11b2">(</span><span class="sf3b2">bin_path</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf3b2">rgb</span><span class="sf11b2">, </span><span class="sf3b2">_</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">read_points3D_binary</span><span class="sf11b2">(</span><span class="sf3b2">bin_path</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">except</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">except</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf3b2">rgb</span><span class="sf11b2">, </span><span class="sf3b2">_</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">read_points3D_text</span><span class="sf11b2">(</span><span class="sf3b2">txt_path</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf3b2">rgb</span><span class="sf11b2">, </span><span class="sf3b2">_</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">read_points3D_text</span><span class="sf11b2">(</span><span class="sf3b2">txt_path</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf3b2">xyz</span><span class="sf11b2">.</span><span class="sf21b2">max</span><span class="sf11b2">(</span><span class="sf10b2">0</span><span class="sf11b2">), </span><span class="sf3b2">xyz</span><span class="sf11b2">.</span><span class="sf21b2">min</span><span class="sf11b2">(</span><span class="sf10b2">0</span><span class="sf11b2">))</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf3b2">xyz</span><span class="sf11b2">.</span><span class="sf21b2">max</span><span class="sf11b2">(</span><span class="sf10b2">0</span><span class="sf11b2">), </span><span class="sf3b2">xyz</span><span class="sf11b2">.</span><span class="sf21b2">min</span><span class="sf11b2">(</span><span class="sf10b2">0</span><span class="sf11b2">))</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">dataset</span><span class="sf11b2">&nbsp;== </span><span class="sf12b2">"LLFF"</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">dataset</span><span class="sf11b2">&nbsp;== </span><span class="sf12b2">"LLFF"</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">pcd_shape</span><span class="sf11b2">&nbsp;= (</span><span class="sf8b2">topk_</span><span class="sf11b2">(</span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">)[-</span><span class="sf10b2">1</span><span class="sf11b2">] + </span><span class="sf8b2">topk_</span><span class="sf11b2">(-</span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">)[-</span><span class="sf10b2">1</span><span class="sf11b2">])</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">pcd_shape</span><span class="sf11b2">&nbsp;= (</span><span class="sf8b2">topk_</span><span class="sf11b2">(</span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">)[-</span><span class="sf10b2">1</span><span class="sf11b2">] + </span><span class="sf8b2">topk_</span><span class="sf11b2">(-</span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">)[-</span><span class="sf10b2">1</span><span class="sf11b2">])</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">num_pts</span><span class="sf11b2">&nbsp;= </span><span class="sf21b2">int</span><span class="sf11b2">(</span><span class="sf3b2">pcd_shape</span><span class="sf11b2">.</span><span class="sf21b2">max</span><span class="sf11b2">() * </span><span class="sf10b2">50</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">num_pts</span><span class="sf11b2">&nbsp;= </span><span class="sf21b2">int</span><span class="sf11b2">(</span><span class="sf3b2">pcd_shape</span><span class="sf11b2">.</span><span class="sf21b2">max</span><span class="sf11b2">() * </span><span class="sf10b2">50</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">xyz</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">random</span><span class="sf11b2">.</span><span class="sf8b2">random</span><span class="sf11b2">((</span><span class="sf3b2">num_pts</span><span class="sf11b2">, </span><span class="sf10b2">3</span><span class="sf11b2">)) * </span><span class="sf3b2">pcd_shape</span><span class="sf11b2">&nbsp;* </span><span class="sf10b2">1.3</span><span class="sf11b2">&nbsp;- </span><span class="sf8b2">topk_</span><span class="sf11b2">(-</span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf10b2">20</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">)[-</span><span class="sf10b2">1</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">xyz</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">random</span><span class="sf11b2">.</span><span class="sf8b2">random</span><span class="sf11b2">((</span><span class="sf3b2">num_pts</span><span class="sf11b2">, </span><span class="sf10b2">3</span><span class="sf11b2">)) * </span><span class="sf3b2">pcd_shape</span><span class="sf11b2">&nbsp;* </span><span class="sf10b2">1.3</span><span class="sf11b2">&nbsp;- </span><span class="sf8b2">topk_</span><span class="sf11b2">(-</span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf10b2">20</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">)[-</span><span class="sf10b2">1</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">elif</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">dataset</span><span class="sf11b2">&nbsp;== </span><span class="sf12b2">"DTU"</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">elif</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">dataset</span><span class="sf11b2">&nbsp;== </span><span class="sf12b2">"DTU"</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">pcd_shape</span><span class="sf11b2">&nbsp;= (</span><span class="sf8b2">topk_</span><span class="sf11b2">(</span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf10b2">100</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">)[-</span><span class="sf10b2">1</span><span class="sf11b2">] + </span><span class="sf8b2">topk_</span><span class="sf11b2">(-</span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf10b2">100</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">)[-</span><span class="sf10b2">1</span><span class="sf11b2">])</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">pcd_shape</span><span class="sf11b2">&nbsp;= (</span><span class="sf8b2">topk_</span><span class="sf11b2">(</span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf10b2">100</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">)[-</span><span class="sf10b2">1</span><span class="sf11b2">] + </span><span class="sf8b2">topk_</span><span class="sf11b2">(-</span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf10b2">100</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">)[-</span><span class="sf10b2">1</span><span class="sf11b2">])</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">num_pts</span><span class="sf11b2">&nbsp;= </span><span class="sf10b2">10_00</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">num_pts</span><span class="sf11b2">&nbsp;= </span><span class="sf10b2">10_00</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">xyz</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">random</span><span class="sf11b2">.</span><span class="sf8b2">random</span><span class="sf11b2">((</span><span class="sf3b2">num_pts</span><span class="sf11b2">, </span><span class="sf10b2">3</span><span class="sf11b2">)) * </span><span class="sf3b2">pcd_shape</span><span class="sf11b2">&nbsp;* </span><span class="sf10b2">1.3</span><span class="sf11b2">&nbsp;- </span><span class="sf8b2">topk_</span><span class="sf11b2">(-</span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf10b2">100</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">)[-</span><span class="sf10b2">1</span><span class="sf11b2">] </span><span class="sf9b2"># - 0.15 * pcd_shape</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">xyz</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">random</span><span class="sf11b2">.</span><span class="sf8b2">random</span><span class="sf11b2">((</span><span class="sf3b2">num_pts</span><span class="sf11b2">, </span><span class="sf10b2">3</span><span class="sf11b2">)) * </span><span class="sf3b2">pcd_shape</span><span class="sf11b2">&nbsp;* </span><span class="sf10b2">1.3</span><span class="sf11b2">&nbsp;- </span><span class="sf8b2">topk_</span><span class="sf11b2">(-</span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf10b2">100</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">)[-</span><span class="sf10b2">1</span><span class="sf11b2">] </span><span class="sf9b2"># - 0.15 * pcd_shape</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf3b2">pcd_shape</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf3b2">pcd_shape</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf3b2">f</span><span class="sf12b2">"Generating random point cloud ({num_pts})..."</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf3b2">f</span><span class="sf12b2">"Generating random point cloud ({num_pts})..."</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">shs</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">random</span><span class="sf11b2">.</span><span class="sf8b2">random</span><span class="sf11b2">((</span><span class="sf3b2">num_pts</span><span class="sf11b2">, </span><span class="sf10b2">3</span><span class="sf11b2">)) / </span><span class="sf10b2">255.0</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">shs</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">random</span><span class="sf11b2">.</span><span class="sf8b2">random</span><span class="sf11b2">((</span><span class="sf3b2">num_pts</span><span class="sf11b2">, </span><span class="sf10b2">3</span><span class="sf11b2">)) / </span><span class="sf10b2">255.0</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">pcd</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">BasicPointCloud</span><span class="sf11b2">(</span><span class="sf3b2">points</span><span class="sf11b2">=</span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf3b2">colors</span><span class="sf11b2">=</span><span class="sf8b2">SH2RGB</span><span class="sf11b2">(</span><span class="sf3b2">shs</span><span class="sf11b2">), </span><span class="sf3b2">normals</span><span class="sf11b2">=</span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">zeros</span><span class="sf11b2">((</span><span class="sf3b2">num_pts</span><span class="sf11b2">, </span><span class="sf10b2">3</span><span class="sf11b2">)))</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">pcd</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">BasicPointCloud</span><span class="sf11b2">(</span><span class="sf3b2">points</span><span class="sf11b2">=</span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf3b2">colors</span><span class="sf11b2">=</span><span class="sf8b2">SH2RGB</span><span class="sf11b2">(</span><span class="sf3b2">shs</span><span class="sf11b2">), </span><span class="sf3b2">normals</span><span class="sf11b2">=</span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">zeros</span><span class="sf11b2">((</span><span class="sf3b2">num_pts</span><span class="sf11b2">, </span><span class="sf10b2">3</span><span class="sf11b2">)))</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf8b2">storePly</span><span class="sf11b2">(</span><span class="sf3b2">ply_path</span><span class="sf11b2">, </span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf8b2">SH2RGB</span><span class="sf11b2">(</span><span class="sf3b2">shs</span><span class="sf11b2">) * </span><span class="sf10b2">255</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf8b2">storePly</span><span class="sf11b2">(</span><span class="sf3b2">ply_path</span><span class="sf11b2">, </span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf8b2">SH2RGB</span><span class="sf11b2">(</span><span class="sf3b2">shs</span><span class="sf11b2">) * </span><span class="sf10b2">255</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"><a id="d5" href="#d5">.</a></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; ">&nbsp; &nbsp; </span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">elif</span><span style="color: #000000; background-color: #efcb05; ">&nbsp;</span><span style="color: #000000; background-color: #efcb05; ">mvs_pcd</span><span style="color: #000000; background-color: #efcb05; ">:</span></code></td>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; ">&nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: #000000; background-color: #efcb05; ">ply_path</span><span style="color: #000000; background-color: #efcb05; ">&nbsp;= </span><span style="color: #000000; background-color: #efcb05; ">os</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">path</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">join</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">path</span><span style="color: #000000; background-color: #efcb05; ">, </span><span style="color: #000000; background-color: #efcb05; ">"3_views/dense/fused.ply"</span><span style="color: #000000; background-color: #efcb05; ">)</span></code></td>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; ">&nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: #000000; background-color: #efcb05; font-weight: bold; ">assert</span><span style="color: #000000; background-color: #efcb05; ">&nbsp;</span><span style="color: #000000; background-color: #efcb05; ">os</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">path</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">exists</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">ply_path</span><span style="color: #000000; background-color: #efcb05; ">)</span></code></td>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; ">&nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: #000000; background-color: #efcb05; ">pcd</span><span style="color: #000000; background-color: #efcb05; ">&nbsp;= </span><span style="color: #000000; background-color: #efcb05; ">fetchPly</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">ply_path</span><span style="color: #000000; background-color: #efcb05; ">)</span></code></td>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">else</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">else</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"><a id="d6" href="#d6">.</a></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; ">&nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: #000000; background-color: #efcb05; ">ply_path</span><span style="color: #000000; background-color: #efcb05; ">&nbsp;= </span><span style="color: #000000; background-color: #efcb05; ">os</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">path</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">join</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">path</span><span style="color: #000000; background-color: #efcb05; ">, </span><span style="color: #000000; background-color: #efcb05; ">"sparse/0/points3D.ply"</span><span style="color: #000000; background-color: #efcb05; ">)</span></code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; ">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf17b18">fused_ply_path = os.path.join(path, "points3D_fused.ply")</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18">&nbsp; &nbsp; &nbsp; &nbsp; if os.path.exists(fused_ply_path):</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span style="color: #000000; background-color: #efcb05; ">ply_path</span><span style="color: #000000; background-color: #efcb05; ">&nbsp;= </span><span class="sf17b18">fused_ply_path</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print("Loaded Fused Point Cloud for Initialization")</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18">&nbsp; &nbsp; &nbsp; &nbsp; else:</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span class="sf17b18">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ply_path = </span><span style="color: #000000; background-color: #efcb05; ">os</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">path</span><span style="color: #000000; background-color: #efcb05; ">.</span><span style="color: #000000; background-color: #efcb05; ">join</span><span style="color: #000000; background-color: #efcb05; ">(</span><span style="color: #000000; background-color: #efcb05; ">path</span><span style="color: #000000; background-color: #efcb05; ">, </span><span style="color: #000000; background-color: #efcb05; ">"sparse/0/points3D.ply"</span><span style="color: #000000; background-color: #efcb05; ">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">bin_path</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"sparse/0/points3D.bin"</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">bin_path</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"sparse/0/points3D.bin"</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">txt_path</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"sparse/0/points3D.txt"</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">txt_path</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"sparse/0/points3D.txt"</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">not</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">exists</span><span class="sf11b2">(</span><span class="sf3b2">ply_path</span><span class="sf11b2">):</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">not</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">exists</span><span class="sf11b2">(</span><span class="sf3b2">ply_path</span><span class="sf11b2">):</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf12b2">"Converting point3d.bin to .ply, will happen only the first time you open the scene."</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf12b2">"Converting point3d.bin to .ply, will happen only the first time you open the scene."</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">try</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">try</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf3b2">rgb</span><span class="sf11b2">, </span><span class="sf3b2">_</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">read_points3D_binary</span><span class="sf11b2">(</span><span class="sf3b2">bin_path</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf3b2">rgb</span><span class="sf11b2">, </span><span class="sf3b2">_</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">read_points3D_binary</span><span class="sf11b2">(</span><span class="sf3b2">bin_path</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">except</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">except</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf3b2">rgb</span><span class="sf11b2">, </span><span class="sf3b2">_</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">read_points3D_text</span><span class="sf11b2">(</span><span class="sf3b2">txt_path</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf3b2">rgb</span><span class="sf11b2">, </span><span class="sf3b2">_</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">read_points3D_text</span><span class="sf11b2">(</span><span class="sf3b2">txt_path</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf8b2">storePly</span><span class="sf11b2">(</span><span class="sf3b2">ply_path</span><span class="sf11b2">, </span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf3b2">rgb</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf8b2">storePly</span><span class="sf11b2">(</span><span class="sf3b2">ply_path</span><span class="sf11b2">, </span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf3b2">rgb</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">try</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">try</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">pcd</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">fetchPly</span><span class="sf11b2">(</span><span class="sf3b2">ply_path</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">pcd</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">fetchPly</span><span class="sf11b2">(</span><span class="sf3b2">ply_path</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">except</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">except</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">pcd</span><span class="sf11b2">&nbsp;= </span><span class="sf20b2">None</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">pcd</span><span class="sf11b2">&nbsp;= </span><span class="sf20b2">None</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">scene_info</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">SceneInfo</span><span class="sf11b2">(</span><span class="sf3b2">point_cloud</span><span class="sf11b2">=</span><span class="sf3b2">pcd</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">scene_info</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">SceneInfo</span><span class="sf11b2">(</span><span class="sf3b2">point_cloud</span><span class="sf11b2">=</span><span class="sf3b2">pcd</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">train_cameras</span><span class="sf11b2">=</span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">train_cameras</span><span class="sf11b2">=</span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">test_cameras</span><span class="sf11b2">=</span><span class="sf3b2">test_cam_infos</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">test_cameras</span><span class="sf11b2">=</span><span class="sf3b2">test_cam_infos</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">eval_cameras</span><span class="sf11b2">=</span><span class="sf3b2">eval_cam_infos</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">eval_cameras</span><span class="sf11b2">=</span><span class="sf3b2">eval_cam_infos</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">=</span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">=</span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">ply_path</span><span class="sf11b2">=</span><span class="sf3b2">ply_path</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">ply_path</span><span class="sf11b2">=</span><span class="sf3b2">ply_path</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">return</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">scene_info</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">return</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">scene_info</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">readCamerasFromTransforms</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf3b2">transformsfile</span><span class="sf11b2">, </span><span class="sf3b2">white_background</span><span class="sf11b2">, </span><span class="sf3b2">extension</span><span class="sf11b2">=</span><span class="sf12b2">".png"</span><span class="sf11b2">):</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">readCamerasFromTransforms</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf3b2">transformsfile</span><span class="sf11b2">, </span><span class="sf3b2">white_background</span><span class="sf11b2">, </span><span class="sf3b2">extension</span><span class="sf11b2">=</span><span class="sf12b2">".png"</span><span class="sf11b2">):</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">cam_infos</span><span class="sf11b2">&nbsp;= []</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">cam_infos</span><span class="sf11b2">&nbsp;= []</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">with</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">open</span><span class="sf11b2">(</span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf3b2">transformsfile</span><span class="sf11b2">)) </span><span class="sf7b2">as</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">json_file</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">with</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">open</span><span class="sf11b2">(</span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf3b2">transformsfile</span><span class="sf11b2">)) </span><span class="sf7b2">as</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">json_file</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">contents</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">json</span><span class="sf11b2">.</span><span class="sf8b2">load</span><span class="sf11b2">(</span><span class="sf3b2">json_file</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">contents</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">json</span><span class="sf11b2">.</span><span class="sf8b2">load</span><span class="sf11b2">(</span><span class="sf3b2">json_file</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">fovx</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">contents</span><span class="sf11b2">[</span><span class="sf12b2">"camera_angle_x"</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">fovx</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">contents</span><span class="sf11b2">[</span><span class="sf12b2">"camera_angle_x"</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">frames</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">contents</span><span class="sf11b2">[</span><span class="sf12b2">"frames"</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">frames</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">contents</span><span class="sf11b2">[</span><span class="sf12b2">"frames"</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">frame</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">enumerate</span><span class="sf11b2">(</span><span class="sf3b2">frames</span><span class="sf11b2">):</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">frame</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">enumerate</span><span class="sf11b2">(</span><span class="sf3b2">frames</span><span class="sf11b2">):</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_name</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf3b2">frame</span><span class="sf11b2">[</span><span class="sf12b2">"file_path"</span><span class="sf11b2">] + </span><span class="sf3b2">extension</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_name</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf3b2">frame</span><span class="sf11b2">[</span><span class="sf12b2">"file_path"</span><span class="sf11b2">] + </span><span class="sf3b2">extension</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># NeRF 'transform_matrix' is a camera-to-world transform</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># NeRF 'transform_matrix' is a camera-to-world transform</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">c2w</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">array</span><span class="sf11b2">(</span><span class="sf3b2">frame</span><span class="sf11b2">[</span><span class="sf12b2">"transform_matrix"</span><span class="sf11b2">])</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">c2w</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">array</span><span class="sf11b2">(</span><span class="sf3b2">frame</span><span class="sf11b2">[</span><span class="sf12b2">"transform_matrix"</span><span class="sf11b2">])</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># change from OpenGL/Blender camera axes (Y up, Z back) to COLMAP (Y down, Z forward)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># change from OpenGL/Blender camera axes (Y up, Z back) to COLMAP (Y down, Z forward)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">c2w</span><span class="sf11b2">[:</span><span class="sf10b2">3</span><span class="sf11b2">, </span><span class="sf10b2">1</span><span class="sf11b2">:</span><span class="sf10b2">3</span><span class="sf11b2">] *= -</span><span class="sf10b2">1</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">c2w</span><span class="sf11b2">[:</span><span class="sf10b2">3</span><span class="sf11b2">, </span><span class="sf10b2">1</span><span class="sf11b2">:</span><span class="sf10b2">3</span><span class="sf11b2">] *= -</span><span class="sf10b2">1</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># get the world-to-camera transform and set R, T</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># get the world-to-camera transform and set R, T</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">w2c</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">linalg</span><span class="sf11b2">.</span><span class="sf8b2">inv</span><span class="sf11b2">(</span><span class="sf3b2">c2w</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">w2c</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">linalg</span><span class="sf11b2">.</span><span class="sf8b2">inv</span><span class="sf11b2">(</span><span class="sf3b2">c2w</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">R</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">transpose</span><span class="sf11b2">(</span><span class="sf3b2">w2c</span><span class="sf11b2">[:</span><span class="sf10b2">3</span><span class="sf11b2">,:</span><span class="sf10b2">3</span><span class="sf11b2">]) &nbsp;</span><span class="sf9b2"># R is stored transposed due to 'glm' in CUDA code</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">R</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">transpose</span><span class="sf11b2">(</span><span class="sf3b2">w2c</span><span class="sf11b2">[:</span><span class="sf10b2">3</span><span class="sf11b2">,:</span><span class="sf10b2">3</span><span class="sf11b2">]) &nbsp;</span><span class="sf9b2"># R is stored transposed due to 'glm' in CUDA code</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">T</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">w2c</span><span class="sf11b2">[:</span><span class="sf10b2">3</span><span class="sf11b2">, </span><span class="sf10b2">3</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">T</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">w2c</span><span class="sf11b2">[:</span><span class="sf10b2">3</span><span class="sf11b2">, </span><span class="sf10b2">3</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">image_path</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf3b2">cam_name</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">image_path</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf3b2">cam_name</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">image_name</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">Path</span><span class="sf11b2">(</span><span class="sf3b2">cam_name</span><span class="sf11b2">).</span><span class="sf3b2">stem</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">image_name</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">Path</span><span class="sf11b2">(</span><span class="sf3b2">cam_name</span><span class="sf11b2">).</span><span class="sf3b2">stem</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">image</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">Image</span><span class="sf11b2">.</span><span class="sf21b2">open</span><span class="sf11b2">(</span><span class="sf3b2">image_path</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">image</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">Image</span><span class="sf11b2">.</span><span class="sf21b2">open</span><span class="sf11b2">(</span><span class="sf3b2">image_path</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">im_data</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">array</span><span class="sf11b2">(</span><span class="sf3b2">image</span><span class="sf11b2">.</span><span class="sf8b2">convert</span><span class="sf11b2">(</span><span class="sf12b2">"RGBA"</span><span class="sf11b2">))</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">im_data</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">array</span><span class="sf11b2">(</span><span class="sf3b2">image</span><span class="sf11b2">.</span><span class="sf8b2">convert</span><span class="sf11b2">(</span><span class="sf12b2">"RGBA"</span><span class="sf11b2">))</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">bg</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">array</span><span class="sf11b2">([</span><span class="sf10b2">1</span><span class="sf11b2">,</span><span class="sf10b2">1</span><span class="sf11b2">,</span><span class="sf10b2">1</span><span class="sf11b2">]) </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">white_background</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">else</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">array</span><span class="sf11b2">([</span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">])</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">bg</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">array</span><span class="sf11b2">([</span><span class="sf10b2">1</span><span class="sf11b2">,</span><span class="sf10b2">1</span><span class="sf11b2">,</span><span class="sf10b2">1</span><span class="sf11b2">]) </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">white_background</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">else</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">array</span><span class="sf11b2">([</span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">])</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">norm_data</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">im_data</span><span class="sf11b2">&nbsp;/ </span><span class="sf10b2">255.0</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">norm_data</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">im_data</span><span class="sf11b2">&nbsp;/ </span><span class="sf10b2">255.0</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">arr</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">norm_data</span><span class="sf11b2">[:,:,:</span><span class="sf10b2">3</span><span class="sf11b2">] * </span><span class="sf3b2">norm_data</span><span class="sf11b2">[:, :, </span><span class="sf10b2">3</span><span class="sf11b2">:</span><span class="sf10b2">4</span><span class="sf11b2">] + </span><span class="sf3b2">bg</span><span class="sf11b2">&nbsp;* (</span><span class="sf10b2">1</span><span class="sf11b2">&nbsp;- </span><span class="sf3b2">norm_data</span><span class="sf11b2">[:, :, </span><span class="sf10b2">3</span><span class="sf11b2">:</span><span class="sf10b2">4</span><span class="sf11b2">])</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">arr</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">norm_data</span><span class="sf11b2">[:,:,:</span><span class="sf10b2">3</span><span class="sf11b2">] * </span><span class="sf3b2">norm_data</span><span class="sf11b2">[:, :, </span><span class="sf10b2">3</span><span class="sf11b2">:</span><span class="sf10b2">4</span><span class="sf11b2">] + </span><span class="sf3b2">bg</span><span class="sf11b2">&nbsp;* (</span><span class="sf10b2">1</span><span class="sf11b2">&nbsp;- </span><span class="sf3b2">norm_data</span><span class="sf11b2">[:, :, </span><span class="sf10b2">3</span><span class="sf11b2">:</span><span class="sf10b2">4</span><span class="sf11b2">])</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">image</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">Image</span><span class="sf11b2">.</span><span class="sf8b2">fromarray</span><span class="sf11b2">(</span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">array</span><span class="sf11b2">(</span><span class="sf3b2">arr</span><span class="sf11b2">*</span><span class="sf10b2">255.0</span><span class="sf11b2">, </span><span class="sf3b2">dtype</span><span class="sf11b2">=</span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">byte</span><span class="sf11b2">), </span><span class="sf12b2">"RGB"</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">image</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">Image</span><span class="sf11b2">.</span><span class="sf8b2">fromarray</span><span class="sf11b2">(</span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">array</span><span class="sf11b2">(</span><span class="sf3b2">arr</span><span class="sf11b2">*</span><span class="sf10b2">255.0</span><span class="sf11b2">, </span><span class="sf3b2">dtype</span><span class="sf11b2">=</span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">byte</span><span class="sf11b2">), </span><span class="sf12b2">"RGB"</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># monocular depth</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># monocular depth</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2">## (fix path)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2">## (fix path)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">depth_mono_path</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf12b2">'/'</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf3b2">image_path</span><span class="sf11b2">.</span><span class="sf8b2">split</span><span class="sf11b2">(<wbr></span><span class="sf12b2">"/"</span><span class="sf11b2">)[:-</span><span class="sf10b2">1</span><span class="sf11b2">]), </span><span class="sf12b2">'depth_maps'</span><span class="sf11b2">, </span><span class="sf12b2">'depth_'</span><span class="sf11b2">&nbsp;+ </span><span class="sf3b2">image_name</span><span class="sf11b2">&nbsp;+ </span><span class="sf12b2">'.png'</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">depth_mono_path</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf12b2">'/'</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf3b2">image_path</span><span class="sf11b2">.</span><span class="sf8b2">split</span><span class="sf11b2">(<wbr></span><span class="sf12b2">"/"</span><span class="sf11b2">)[:-</span><span class="sf10b2">1</span><span class="sf11b2">]), </span><span class="sf12b2">'depth_maps'</span><span class="sf11b2">, </span><span class="sf12b2">'depth_'</span><span class="sf11b2">&nbsp;+ </span><span class="sf3b2">image_name</span><span class="sf11b2">&nbsp;+ </span><span class="sf12b2">'.png'</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">depth_mono</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">Image</span><span class="sf11b2">.</span><span class="sf21b2">open</span><span class="sf11b2">(</span><span class="sf3b2">depth_mono_path</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">depth_mono</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">Image</span><span class="sf11b2">.</span><span class="sf21b2">open</span><span class="sf11b2">(</span><span class="sf3b2">depth_mono_path</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">fovy</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">focal2fov</span><span class="sf11b2">(</span><span class="sf8b2">fov2focal</span><span class="sf11b2">(</span><span class="sf3b2">fovx</span><span class="sf11b2">, </span><span class="sf3b2">image</span><span class="sf11b2">.</span><span class="sf3b2">size</span><span class="sf11b2">[</span><span class="sf10b2">0</span><span class="sf11b2">]), </span><span class="sf3b2">image</span><span class="sf11b2">.</span><span class="sf3b2">size</span><span class="sf11b2">[</span><span class="sf10b2">1</span><span class="sf11b2">])</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">fovy</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">focal2fov</span><span class="sf11b2">(</span><span class="sf8b2">fov2focal</span><span class="sf11b2">(</span><span class="sf3b2">fovx</span><span class="sf11b2">, </span><span class="sf3b2">image</span><span class="sf11b2">.</span><span class="sf3b2">size</span><span class="sf11b2">[</span><span class="sf10b2">0</span><span class="sf11b2">]), </span><span class="sf3b2">image</span><span class="sf11b2">.</span><span class="sf3b2">size</span><span class="sf11b2">[</span><span class="sf10b2">1</span><span class="sf11b2">])</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">FovY</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">fovy</span><span class="sf11b2">&nbsp;</span>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">FovY</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">fovy</span><span class="sf11b2">&nbsp;</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">FovX</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">fovx</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">FovX</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">fovx</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_infos</span><span class="sf11b2">.</span><span class="sf8b2">append</span><span class="sf11b2">(</span><span class="sf8b2">CameraInfo</span><span class="sf11b2">(</span><span class="sf3b2">uid</span><span class="sf11b2">=</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">R</span><span class="sf11b2">=</span><span class="sf3b2">R</span><span class="sf11b2">, </span><span class="sf3b2">T</span><span class="sf11b2">=</span><span class="sf3b2">T</span><span class="sf11b2">, </span><span class="sf3b2">FovY</span><span class="sf11b2">=</span><span class="sf3b2">FovY</span><span class="sf11b2">, </span><span class="sf3b2">FovX</span><span class="sf11b2">=</span><span class="sf3b2">FovX</span><span class="sf11b2">, </span><span class="sf3b2">image</span><span class="sf11b2">=</span><span class="sf3b2">image</span><span class="sf11b2">, </span><span class="sf3b2">depth_mono</span><span class="sf11b2">=</span><span class="sf3b2">depth_mono</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_infos</span><span class="sf11b2">.</span><span class="sf8b2">append</span><span class="sf11b2">(</span><span class="sf8b2">CameraInfo</span><span class="sf11b2">(</span><span class="sf3b2">uid</span><span class="sf11b2">=</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">R</span><span class="sf11b2">=</span><span class="sf3b2">R</span><span class="sf11b2">, </span><span class="sf3b2">T</span><span class="sf11b2">=</span><span class="sf3b2">T</span><span class="sf11b2">, </span><span class="sf3b2">FovY</span><span class="sf11b2">=</span><span class="sf3b2">FovY</span><span class="sf11b2">, </span><span class="sf3b2">FovX</span><span class="sf11b2">=</span><span class="sf3b2">FovX</span><span class="sf11b2">, </span><span class="sf3b2">image</span><span class="sf11b2">=</span><span class="sf3b2">image</span><span class="sf11b2">, </span><span class="sf3b2">depth_mono</span><span class="sf11b2">=</span><span class="sf3b2">depth_mono</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">image_path</span><span class="sf11b2">=</span><span class="sf3b2">image_path</span><span class="sf11b2">, </span><span class="sf3b2">image_name</span><span class="sf11b2">=</span><span class="sf3b2">image_name</span><span class="sf11b2">, </span><span class="sf3b2">width</span><span class="sf11b2">=</span><span class="sf3b2">image</span><span class="sf11b2">.</span><span class="sf3b2">size</span><span class="sf11b2">[</span><span class="sf10b2">0</span><span class="sf11b2">], </span><span class="sf3b2">height</span><span class="sf11b2">=</span><span class="sf3b2">image</span><span class="sf11b2">.</span><span class="sf3b2">size</span><span class="sf11b2">[</span><span class="sf10b2">1</span><span class="sf11b2">]))</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">image_path</span><span class="sf11b2">=</span><span class="sf3b2">image_path</span><span class="sf11b2">, </span><span class="sf3b2">image_name</span><span class="sf11b2">=</span><span class="sf3b2">image_name</span><span class="sf11b2">, </span><span class="sf3b2">width</span><span class="sf11b2">=</span><span class="sf3b2">image</span><span class="sf11b2">.</span><span class="sf3b2">size</span><span class="sf11b2">[</span><span class="sf10b2">0</span><span class="sf11b2">], </span><span class="sf3b2">height</span><span class="sf11b2">=</span><span class="sf3b2">image</span><span class="sf11b2">.</span><span class="sf3b2">size</span><span class="sf11b2">[</span><span class="sf10b2">1</span><span class="sf11b2">]))</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">return</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">cam_infos</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">return</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">cam_infos</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">readNerfSyntheticInfo</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf3b2">white_background</span><span class="sf11b2">, </span><span class="sf21b2">eval</span><span class="sf11b2">, </span><span class="sf3b2">rand_pcd</span><span class="sf11b2">, </span><span class="sf3b2">llffhold</span><span class="sf11b2">=</span><span class="sf10b2">8</span><span class="sf11b2">, </span><span class="sf3b2">N_sparse</span><span class="sf11b2">=-</span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf3b2">extension</span><span class="sf11b2">=</span><span class="sf12b2">".png"</span><span class="sf11b2">):</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">readNerfSyntheticInfo</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf3b2">white_background</span><span class="sf11b2">, </span><span class="sf21b2">eval</span><span class="sf11b2">, </span><span class="sf3b2">rand_pcd</span><span class="sf11b2">, </span><span class="sf3b2">llffhold</span><span class="sf11b2">=</span><span class="sf10b2">8</span><span class="sf11b2">, </span><span class="sf3b2">N_sparse</span><span class="sf11b2">=-</span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf3b2">extension</span><span class="sf11b2">=</span><span class="sf12b2">".png"</span><span class="sf11b2">):</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf12b2">"Reading Training Transforms"</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf12b2">"Reading Training Transforms"</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">readCamerasFromTransforms</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"transforms_train.json"</span><span class="sf11b2">, </span><span class="sf3b2">white_background</span><span class="sf11b2">, </span><span class="sf3b2">extension</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">readCamerasFromTransforms</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"transforms_train.json"</span><span class="sf11b2">, </span><span class="sf3b2">white_background</span><span class="sf11b2">, </span><span class="sf3b2">extension</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf12b2">"Reading Test Transforms"</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf12b2">"Reading Test Transforms"</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">test_cam_infos</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">readCamerasFromTransforms</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"transforms_test.json"</span><span class="sf11b2">, </span><span class="sf3b2">white_background</span><span class="sf11b2">, </span><span class="sf3b2">extension</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">test_cam_infos</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">readCamerasFromTransforms</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"transforms_test.json"</span><span class="sf11b2">, </span><span class="sf3b2">white_background</span><span class="sf11b2">, </span><span class="sf3b2">extension</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">eval</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">eval</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">N_sparse</span><span class="sf11b2">&nbsp;&gt; </span><span class="sf10b2">0</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">N_sparse</span><span class="sf11b2">&nbsp;&gt; </span><span class="sf10b2">0</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">&nbsp;= [</span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">enumerate</span><span class="sf11b2">(</span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">) </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;[</span><span class="sf10b2">2</span><span class="sf11b2">, </span><span class="sf10b2">16</span><span class="sf11b2">, </span><span class="sf10b2">26</span><span class="sf11b2">, </span><span class="sf10b2">55</span><span class="sf11b2">, </span><span class="sf10b2">73</span><span class="sf11b2">, </span><span class="sf10b2">76</span><span class="sf11b2">, </span><span class="sf10b2">86</span><span class="sf11b2">, </span><span class="sf10b2">93</span><span class="sf11b2">]]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">&nbsp;= [</span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">enumerate</span><span class="sf11b2">(</span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">) </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;[</span><span class="sf10b2">2</span><span class="sf11b2">, </span><span class="sf10b2">16</span><span class="sf11b2">, </span><span class="sf10b2">26</span><span class="sf11b2">, </span><span class="sf10b2">55</span><span class="sf11b2">, </span><span class="sf10b2">73</span><span class="sf11b2">, </span><span class="sf10b2">76</span><span class="sf11b2">, </span><span class="sf10b2">86</span><span class="sf11b2">, </span><span class="sf10b2">93</span><span class="sf11b2">]]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">eval_cam_infos</span><span class="sf11b2">&nbsp;= [</span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">enumerate</span><span class="sf11b2">(</span><span class="sf3b2">test_cam_infos</span><span class="sf11b2">) </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">&nbsp;% </span><span class="sf3b2">llffhold</span><span class="sf11b2">&nbsp;== </span><span class="sf10b2">0</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">eval_cam_infos</span><span class="sf11b2">&nbsp;= [</span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">c</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">enumerate</span><span class="sf11b2">(</span><span class="sf3b2">test_cam_infos</span><span class="sf11b2">) </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">&nbsp;% </span><span class="sf3b2">llffhold</span><span class="sf11b2">&nbsp;== </span><span class="sf10b2">0</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">test_cam_infos</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">test_cam_infos</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">test_cam_infos</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">test_cam_infos</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">else</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">else</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">test_cam_infos</span><span class="sf11b2">&nbsp;= []</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">test_cam_infos</span><span class="sf11b2">&nbsp;= []</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">eval_cam_infos</span><span class="sf11b2">&nbsp;= []</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">eval_cam_infos</span><span class="sf11b2">&nbsp;= []</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf12b2">'train'</span><span class="sf11b2">, [</span><span class="sf3b2">info</span><span class="sf11b2">.</span><span class="sf3b2">image_path</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">info</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">])</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf12b2">'train'</span><span class="sf11b2">, [</span><span class="sf3b2">info</span><span class="sf11b2">.</span><span class="sf3b2">image_path</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">info</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">])</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf12b2">'eval'</span><span class="sf11b2">, [</span><span class="sf3b2">info</span><span class="sf11b2">.</span><span class="sf3b2">image_path</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">info</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">eval_cam_infos</span><span class="sf11b2">])</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf12b2">'eval'</span><span class="sf11b2">, [</span><span class="sf3b2">info</span><span class="sf11b2">.</span><span class="sf3b2">image_path</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">info</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">eval_cam_infos</span><span class="sf11b2">])</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">getNerfppNorm</span><span class="sf11b2">(</span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">getNerfppNorm</span><span class="sf11b2">(</span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">ply_path</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"points3d.ply"</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">ply_path</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf20b2">path</span><span class="sf11b2">, </span><span class="sf12b2">"points3d.ply"</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">rand_pcd</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">rand_pcd</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf12b2">'Init random point cloud.'</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf12b2">'Init random point cloud.'</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">rand_pcd</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">or</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">not</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">exists</span><span class="sf11b2">(</span><span class="sf3b2">ply_path</span><span class="sf11b2">):</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">if</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">rand_pcd</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">or</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">not</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">exists</span><span class="sf11b2">(</span><span class="sf3b2">ply_path</span><span class="sf11b2">):</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># Since this data set has no colmap data, we start with random points</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># Since this data set has no colmap data, we start with random points</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">num_pts</span><span class="sf11b2">&nbsp;= </span><span class="sf10b2">10_000</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">num_pts</span><span class="sf11b2">&nbsp;= </span><span class="sf10b2">10_000</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf3b2">f</span><span class="sf12b2">"Generating random point cloud ({num_pts})..."</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf21b2">print</span><span class="sf11b2">(</span><span class="sf3b2">f</span><span class="sf12b2">"Generating random point cloud ({num_pts})..."</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># We create random points inside the bounds of the synthetic Blender scenes</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># We create random points inside the bounds of the synthetic Blender scenes</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">xyz</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">random</span><span class="sf11b2">.</span><span class="sf8b2">random</span><span class="sf11b2">((</span><span class="sf3b2">num_pts</span><span class="sf11b2">, </span><span class="sf10b2">3</span><span class="sf11b2">)) * </span><span class="sf10b2">2</span><span class="sf11b2">&nbsp;- </span><span class="sf10b2">1</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">xyz</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">random</span><span class="sf11b2">.</span><span class="sf8b2">random</span><span class="sf11b2">((</span><span class="sf3b2">num_pts</span><span class="sf11b2">, </span><span class="sf10b2">3</span><span class="sf11b2">)) * </span><span class="sf10b2">2</span><span class="sf11b2">&nbsp;- </span><span class="sf10b2">1</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">shs</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">random</span><span class="sf11b2">.</span><span class="sf8b2">random</span><span class="sf11b2">((</span><span class="sf3b2">num_pts</span><span class="sf11b2">, </span><span class="sf10b2">3</span><span class="sf11b2">)) / </span><span class="sf10b2">255.0</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">shs</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">random</span><span class="sf11b2">.</span><span class="sf8b2">random</span><span class="sf11b2">((</span><span class="sf3b2">num_pts</span><span class="sf11b2">, </span><span class="sf10b2">3</span><span class="sf11b2">)) / </span><span class="sf10b2">255.0</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">pcd</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">BasicPointCloud</span><span class="sf11b2">(</span><span class="sf3b2">points</span><span class="sf11b2">=</span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf3b2">colors</span><span class="sf11b2">=</span><span class="sf8b2">SH2RGB</span><span class="sf11b2">(</span><span class="sf3b2">shs</span><span class="sf11b2">), </span><span class="sf3b2">normals</span><span class="sf11b2">=</span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">zeros</span><span class="sf11b2">((</span><span class="sf3b2">num_pts</span><span class="sf11b2">, </span><span class="sf10b2">3</span><span class="sf11b2">)))</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">pcd</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">BasicPointCloud</span><span class="sf11b2">(</span><span class="sf3b2">points</span><span class="sf11b2">=</span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf3b2">colors</span><span class="sf11b2">=</span><span class="sf8b2">SH2RGB</span><span class="sf11b2">(</span><span class="sf3b2">shs</span><span class="sf11b2">), </span><span class="sf3b2">normals</span><span class="sf11b2">=</span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">zeros</span><span class="sf11b2">((</span><span class="sf3b2">num_pts</span><span class="sf11b2">, </span><span class="sf10b2">3</span><span class="sf11b2">)))</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf8b2">storePly</span><span class="sf11b2">(</span><span class="sf3b2">ply_path</span><span class="sf11b2">, </span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf8b2">SH2RGB</span><span class="sf11b2">(</span><span class="sf3b2">shs</span><span class="sf11b2">) * </span><span class="sf10b2">255</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf8b2">storePly</span><span class="sf11b2">(</span><span class="sf3b2">ply_path</span><span class="sf11b2">, </span><span class="sf3b2">xyz</span><span class="sf11b2">, </span><span class="sf8b2">SH2RGB</span><span class="sf11b2">(</span><span class="sf3b2">shs</span><span class="sf11b2">) * </span><span class="sf10b2">255</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">try</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">try</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">pcd</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">fetchPly</span><span class="sf11b2">(</span><span class="sf3b2">ply_path</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">pcd</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">fetchPly</span><span class="sf11b2">(</span><span class="sf3b2">ply_path</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">except</span><span class="sf11b2">:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">except</span><span class="sf11b2">:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">pcd</span><span class="sf11b2">&nbsp;= </span><span class="sf20b2">None</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">pcd</span><span class="sf11b2">&nbsp;= </span><span class="sf20b2">None</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">scene_info</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">SceneInfo</span><span class="sf11b2">(</span><span class="sf3b2">point_cloud</span><span class="sf11b2">=</span><span class="sf3b2">pcd</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">scene_info</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">SceneInfo</span><span class="sf11b2">(</span><span class="sf3b2">point_cloud</span><span class="sf11b2">=</span><span class="sf3b2">pcd</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">train_cameras</span><span class="sf11b2">=</span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">train_cameras</span><span class="sf11b2">=</span><span class="sf3b2">train_cam_infos</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">test_cameras</span><span class="sf11b2">=</span><span class="sf3b2">test_cam_infos</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">test_cameras</span><span class="sf11b2">=</span><span class="sf3b2">test_cam_infos</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">eval_cameras</span><span class="sf11b2">=</span><span class="sf3b2">eval_cam_infos</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">eval_cameras</span><span class="sf11b2">=</span><span class="sf3b2">eval_cam_infos</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">=</span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">=</span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">ply_path</span><span class="sf11b2">=</span><span class="sf3b2">ply_path</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">ply_path</span><span class="sf11b2">=</span><span class="sf3b2">ply_path</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">return</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">scene_info</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">return</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">scene_info</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">generateLLFFCameras</span><span class="sf11b2">(</span><span class="sf3b2">poses</span><span class="sf11b2">):</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">generateLLFFCameras</span><span class="sf11b2">(</span><span class="sf3b2">poses</span><span class="sf11b2">):</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">cam_infos</span><span class="sf11b2">&nbsp;= []</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">cam_infos</span><span class="sf11b2">&nbsp;= []</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">Rs</span><span class="sf11b2">, </span><span class="sf3b2">tvecs</span><span class="sf11b2">, </span><span class="sf3b2">height</span><span class="sf11b2">, </span><span class="sf3b2">width</span><span class="sf11b2">, </span><span class="sf3b2">focal_length_x</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">pose_utils</span><span class="sf11b2">.</span><span class="sf8b2">convert_poses</span><span class="sf11b2">(</span><span class="sf3b2">poses</span><span class="sf11b2">) </span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">Rs</span><span class="sf11b2">, </span><span class="sf3b2">tvecs</span><span class="sf11b2">, </span><span class="sf3b2">height</span><span class="sf11b2">, </span><span class="sf3b2">width</span><span class="sf11b2">, </span><span class="sf3b2">focal_length_x</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">pose_utils</span><span class="sf11b2">.</span><span class="sf8b2">convert_poses</span><span class="sf11b2">(</span><span class="sf3b2">poses</span><span class="sf11b2">) </span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># print(Rs, tvecs, height, width, focal_length_x)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># print(Rs, tvecs, height, width, focal_length_x)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">_</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">enumerate</span><span class="sf11b2">(</span><span class="sf3b2">Rs</span><span class="sf11b2">):</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">for</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">idx</span><span class="sf11b2">, </span><span class="sf3b2">_</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">in</span><span class="sf11b2">&nbsp;</span><span class="sf21b2">enumerate</span><span class="sf11b2">(</span><span class="sf3b2">Rs</span><span class="sf11b2">):</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">sys</span><span class="sf11b2">.</span><span class="sf20b2">stdout</span><span class="sf11b2">.</span><span class="sf8b2">write</span><span class="sf11b2">(</span><span class="sf12b2">'\r'</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">sys</span><span class="sf11b2">.</span><span class="sf20b2">stdout</span><span class="sf11b2">.</span><span class="sf8b2">write</span><span class="sf11b2">(</span><span class="sf12b2">'\r'</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># the exact output you're looking for:</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf9b2"># the exact output you're looking for:</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">sys</span><span class="sf11b2">.</span><span class="sf20b2">stdout</span><span class="sf11b2">.</span><span class="sf8b2">write</span><span class="sf11b2">(</span><span class="sf12b2">"Reading camera {}/{}"</span><span class="sf11b2">.</span><span class="sf21b2">format</span><span class="sf11b2">(</span><span class="sf3b2">idx</span><span class="sf11b2">+</span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf21b2">len</span><span class="sf11b2">(</span><span class="sf3b2">Rs</span><span class="sf11b2">)))</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">sys</span><span class="sf11b2">.</span><span class="sf20b2">stdout</span><span class="sf11b2">.</span><span class="sf8b2">write</span><span class="sf11b2">(</span><span class="sf12b2">"Reading camera {}/{}"</span><span class="sf11b2">.</span><span class="sf21b2">format</span><span class="sf11b2">(</span><span class="sf3b2">idx</span><span class="sf11b2">+</span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf21b2">len</span><span class="sf11b2">(</span><span class="sf3b2">Rs</span><span class="sf11b2">)))</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">sys</span><span class="sf11b2">.</span><span class="sf20b2">stdout</span><span class="sf11b2">.</span><span class="sf8b2">flush</span><span class="sf11b2">()</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">sys</span><span class="sf11b2">.</span><span class="sf20b2">stdout</span><span class="sf11b2">.</span><span class="sf8b2">flush</span><span class="sf11b2">()</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">uid</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">idx</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">uid</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">idx</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">R</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">transpose</span><span class="sf11b2">(</span><span class="sf3b2">Rs</span><span class="sf11b2">[</span><span class="sf3b2">idx</span><span class="sf11b2">])</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">R</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">transpose</span><span class="sf11b2">(</span><span class="sf3b2">Rs</span><span class="sf11b2">[</span><span class="sf3b2">idx</span><span class="sf11b2">])</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">T</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">tvecs</span><span class="sf11b2">[</span><span class="sf3b2">idx</span><span class="sf11b2">]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">T</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">tvecs</span><span class="sf11b2">[</span><span class="sf3b2">idx</span><span class="sf11b2">]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">FovY</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">focal2fov</span><span class="sf11b2">(</span><span class="sf3b2">focal_length_x</span><span class="sf11b2">, </span><span class="sf3b2">height</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">FovY</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">focal2fov</span><span class="sf11b2">(</span><span class="sf3b2">focal_length_x</span><span class="sf11b2">, </span><span class="sf3b2">height</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">FovX</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">focal2fov</span><span class="sf11b2">(</span><span class="sf3b2">focal_length_x</span><span class="sf11b2">, </span><span class="sf3b2">width</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">FovX</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">focal2fov</span><span class="sf11b2">(</span><span class="sf3b2">focal_length_x</span><span class="sf11b2">, </span><span class="sf3b2">width</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_info</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">CameraInfo</span><span class="sf11b2">(</span><span class="sf3b2">uid</span><span class="sf11b2">=</span><span class="sf3b2">uid</span><span class="sf11b2">, </span><span class="sf3b2">R</span><span class="sf11b2">=</span><span class="sf3b2">R</span><span class="sf11b2">, </span><span class="sf3b2">T</span><span class="sf11b2">=</span><span class="sf3b2">T</span><span class="sf11b2">, </span><span class="sf3b2">FovY</span><span class="sf11b2">=</span><span class="sf3b2">FovY</span><span class="sf11b2">, </span><span class="sf3b2">FovX</span><span class="sf11b2">=</span><span class="sf3b2">FovX</span><span class="sf11b2">, </span><span class="sf3b2">image</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">, </span><span class="sf3b2">depth_mono</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">, </span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_info</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">CameraInfo</span><span class="sf11b2">(</span><span class="sf3b2">uid</span><span class="sf11b2">=</span><span class="sf3b2">uid</span><span class="sf11b2">, </span><span class="sf3b2">R</span><span class="sf11b2">=</span><span class="sf3b2">R</span><span class="sf11b2">, </span><span class="sf3b2">T</span><span class="sf11b2">=</span><span class="sf3b2">T</span><span class="sf11b2">, </span><span class="sf3b2">FovY</span><span class="sf11b2">=</span><span class="sf3b2">FovY</span><span class="sf11b2">, </span><span class="sf3b2">FovX</span><span class="sf11b2">=</span><span class="sf3b2">FovX</span><span class="sf11b2">, </span><span class="sf3b2">image</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">, </span><span class="sf3b2">depth_mono</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">, </span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">image_path</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">, </span><span class="sf3b2">image_name</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">, </span><span class="sf3b2">width</span><span class="sf11b2">=</span><span class="sf3b2">width</span><span class="sf11b2">, </span><span class="sf3b2">height</span><span class="sf11b2">=</span><span class="sf3b2">height</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">image_path</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">, </span><span class="sf3b2">image_name</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">, </span><span class="sf3b2">width</span><span class="sf11b2">=</span><span class="sf3b2">width</span><span class="sf11b2">, </span><span class="sf3b2">height</span><span class="sf11b2">=</span><span class="sf3b2">height</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_infos</span><span class="sf11b2">.</span><span class="sf8b2">append</span><span class="sf11b2">(</span><span class="sf3b2">cam_info</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">cam_infos</span><span class="sf11b2">.</span><span class="sf8b2">append</span><span class="sf11b2">(</span><span class="sf3b2">cam_info</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">sys</span><span class="sf11b2">.</span><span class="sf20b2">stdout</span><span class="sf11b2">.</span><span class="sf8b2">write</span><span class="sf11b2">(</span><span class="sf12b2">'\n'</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">sys</span><span class="sf11b2">.</span><span class="sf20b2">stdout</span><span class="sf11b2">.</span><span class="sf8b2">write</span><span class="sf11b2">(</span><span class="sf12b2">'\n'</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">return</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">cam_infos</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">return</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">cam_infos</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">from</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">utils</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">pose_utils</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">from</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">utils</span><span class="sf11b2">&nbsp;</span><span class="sf7b2">import</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">pose_utils</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">CreateLLFFSpiral</span><span class="sf11b2">(</span><span class="sf3b2">basedir</span><span class="sf11b2">):</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">CreateLLFFSpiral</span><span class="sf11b2">(</span><span class="sf3b2">basedir</span><span class="sf11b2">):</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Load poses and bounds.</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Load poses and bounds.</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">poses_arr</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">load</span><span class="sf11b2">(</span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf3b2">basedir</span><span class="sf11b2">, </span><span class="sf12b2">'poses_bounds.npy'</span><span class="sf11b2">))</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">poses_arr</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">load</span><span class="sf11b2">(</span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf3b2">basedir</span><span class="sf11b2">, </span><span class="sf12b2">'poses_bounds.npy'</span><span class="sf11b2">))</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">poses_o</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">poses_arr</span><span class="sf11b2">[:, :-</span><span class="sf10b2">2</span><span class="sf11b2">].</span><span class="sf8b2">reshape</span><span class="sf11b2">([-</span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">3</span><span class="sf11b2">, </span><span class="sf10b2">5</span><span class="sf11b2">])</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">poses_o</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">poses_arr</span><span class="sf11b2">[:, :-</span><span class="sf10b2">2</span><span class="sf11b2">].</span><span class="sf8b2">reshape</span><span class="sf11b2">([-</span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">3</span><span class="sf11b2">, </span><span class="sf10b2">5</span><span class="sf11b2">])</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">bounds</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">poses_arr</span><span class="sf11b2">[:, -</span><span class="sf10b2">2</span><span class="sf11b2">:]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">bounds</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">poses_arr</span><span class="sf11b2">[:, -</span><span class="sf10b2">2</span><span class="sf11b2">:]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Pull out focal length before processing poses.</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Pull out focal length before processing poses.</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Correct rotation matrix ordering (and drop 5th column of poses).</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Correct rotation matrix ordering (and drop 5th column of poses).</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">fix_rotation</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">array</span><span class="sf11b2">([</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">fix_rotation</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">array</span><span class="sf11b2">([</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; [</span><span class="sf10b2">0</span><span class="sf11b2">, -</span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">],</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; [</span><span class="sf10b2">0</span><span class="sf11b2">, -</span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">],</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; [</span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">],</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; [</span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">],</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; [</span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">],</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; [</span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">],</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; [</span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">1</span><span class="sf11b2">],</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; [</span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">1</span><span class="sf11b2">],</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; ],</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; ],</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">dtype</span><span class="sf11b2">=</span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">float32</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">dtype</span><span class="sf11b2">=</span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">float32</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">inv_rotation</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">linalg</span><span class="sf11b2">.</span><span class="sf8b2">inv</span><span class="sf11b2">(</span><span class="sf3b2">fix_rotation</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">inv_rotation</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">linalg</span><span class="sf11b2">.</span><span class="sf8b2">inv</span><span class="sf11b2">(</span><span class="sf3b2">fix_rotation</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">poses_o</span><span class="sf11b2">[:, :</span><span class="sf10b2">3</span><span class="sf11b2">, :</span><span class="sf10b2">4</span><span class="sf11b2">] @ </span><span class="sf3b2">fix_rotation</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">poses_o</span><span class="sf11b2">[:, :</span><span class="sf10b2">3</span><span class="sf11b2">, :</span><span class="sf10b2">4</span><span class="sf11b2">] @ </span><span class="sf3b2">fix_rotation</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Rescale according to a default bd factor.</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Rescale according to a default bd factor.</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># scale = 1. / (bounds.min() * .75)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># scale = 1. / (bounds.min() * .75)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># poses[:, :3, 3] *= scale</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># poses[:, :3, 3] *= scale</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># bounds *= scale</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># bounds *= scale</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Recenter poses.</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Recenter poses.</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">pose_utils</span><span class="sf11b2">.</span><span class="sf8b2">recenter_poses</span><span class="sf11b2">(</span><span class="sf3b2">poses</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">pose_utils</span><span class="sf11b2">.</span><span class="sf8b2">recenter_poses</span><span class="sf11b2">(</span><span class="sf3b2">poses</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Separate out 360 versus forward facing scenes.</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Separate out 360 versus forward facing scenes.</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">pose_utils</span><span class="sf11b2">.</span><span class="sf8b2">generate_spiral_path</span><span class="sf11b2">(</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">pose_utils</span><span class="sf11b2">.</span><span class="sf8b2">generate_spiral_path</span><span class="sf11b2">(</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">, </span><span class="sf3b2">bounds</span><span class="sf11b2">, </span><span class="sf3b2">n_frames</span><span class="sf11b2">=</span><span class="sf10b2">180</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">, </span><span class="sf3b2">bounds</span><span class="sf11b2">, </span><span class="sf3b2">n_frames</span><span class="sf11b2">=</span><span class="sf10b2">180</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">pose_utils</span><span class="sf11b2">.</span><span class="sf8b2">backcenter_poses</span><span class="sf11b2">(</span><span class="sf3b2">render_pose<wbr>s</span><span class="sf11b2">, </span><span class="sf3b2">poses</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">pose_utils</span><span class="sf11b2">.</span><span class="sf8b2">backcenter_poses</span><span class="sf11b2">(</span><span class="sf3b2">render_pose<wbr>s</span><span class="sf11b2">, </span><span class="sf3b2">poses</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;@ </span><span class="sf3b2">inv_rotation</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;@ </span><span class="sf3b2">inv_rotation</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">concatenate</span><span class="sf11b2">([</span><span class="sf3b2">render_poses</span><span class="sf11b2">, </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">tile</span><span class="sf11b2">(</span><span class="sf3b2">poses_o</span><span class="sf11b2">[:</span><span class="sf10b2">1</span><span class="sf11b2">, :</span><span class="sf10b2">3</span><span class="sf11b2">, </span><span class="sf10b2">4</span><span class="sf11b2">:], (</span><span class="sf3b2">render_poses</span><span class="sf11b2">.</span><span class="sf3b2">shape</span><span class="sf11b2">[</span><span class="sf10b2">0</span><span class="sf11b2">], </span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">1</span><span class="sf11b2">))], -</span><span class="sf10b2">1</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">concatenate</span><span class="sf11b2">([</span><span class="sf3b2">render_poses</span><span class="sf11b2">, </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">tile</span><span class="sf11b2">(</span><span class="sf3b2">poses_o</span><span class="sf11b2">[:</span><span class="sf10b2">1</span><span class="sf11b2">, :</span><span class="sf10b2">3</span><span class="sf11b2">, </span><span class="sf10b2">4</span><span class="sf11b2">:], (</span><span class="sf3b2">render_poses</span><span class="sf11b2">.</span><span class="sf3b2">shape</span><span class="sf11b2">[</span><span class="sf10b2">0</span><span class="sf11b2">], </span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">1</span><span class="sf11b2">))], -</span><span class="sf10b2">1</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_cam_infos</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">generateLLFFCameras</span><span class="sf11b2">(</span><span class="sf3b2">render_poses</span><span class="sf11b2">.</span><span class="sf8b2">transp<wbr>ose</span><span class="sf11b2">([</span><span class="sf10b2">1</span><span class="sf11b2">,</span><span class="sf10b2">2</span><span class="sf11b2">,</span><span class="sf10b2">0</span><span class="sf11b2">]))</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_cam_infos</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">generateLLFFCameras</span><span class="sf11b2">(</span><span class="sf3b2">render_poses</span><span class="sf11b2">.</span><span class="sf8b2">transp<wbr>ose</span><span class="sf11b2">([</span><span class="sf10b2">1</span><span class="sf11b2">,</span><span class="sf10b2">2</span><span class="sf11b2">,</span><span class="sf10b2">0</span><span class="sf11b2">]))</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">getNerfppNorm</span><span class="sf11b2">(</span><span class="sf3b2">render_cam_infos</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">getNerfppNorm</span><span class="sf11b2">(</span><span class="sf3b2">render_cam_infos</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">scene_info</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">SceneInfo</span><span class="sf11b2">(</span><span class="sf3b2">point_cloud</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">scene_info</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">SceneInfo</span><span class="sf11b2">(</span><span class="sf3b2">point_cloud</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">train_cameras</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">train_cameras</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">test_cameras</span><span class="sf11b2">=</span><span class="sf3b2">render_cam_infos</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">test_cameras</span><span class="sf11b2">=</span><span class="sf3b2">render_cam_infos</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">eval_cameras</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">eval_cameras</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">=</span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">=</span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">ply_path</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">ply_path</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">return</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">scene_info</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">return</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">scene_info</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">CreateDTUSpiral</span><span class="sf11b2">(</span><span class="sf3b2">basedir</span><span class="sf11b2">):</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf7b2">def</span><span class="sf11b2">&nbsp;</span><span class="sf8b2">CreateDTUSpiral</span><span class="sf11b2">(</span><span class="sf3b2">basedir</span><span class="sf11b2">):</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Load poses and bounds.</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Load poses and bounds.</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">poses_arr</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">load</span><span class="sf11b2">(</span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf3b2">basedir</span><span class="sf11b2">, </span><span class="sf12b2">'poses_bounds.npy'</span><span class="sf11b2">))</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">poses_arr</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">load</span><span class="sf11b2">(</span><span class="sf3b2">os</span><span class="sf11b2">.</span><span class="sf20b2">path</span><span class="sf11b2">.</span><span class="sf8b2">join</span><span class="sf11b2">(</span><span class="sf3b2">basedir</span><span class="sf11b2">, </span><span class="sf12b2">'poses_bounds.npy'</span><span class="sf11b2">))</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">poses_o</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">poses_arr</span><span class="sf11b2">[:, :-</span><span class="sf10b2">2</span><span class="sf11b2">].</span><span class="sf8b2">reshape</span><span class="sf11b2">([-</span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">3</span><span class="sf11b2">, </span><span class="sf10b2">5</span><span class="sf11b2">])</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">poses_o</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">poses_arr</span><span class="sf11b2">[:, :-</span><span class="sf10b2">2</span><span class="sf11b2">].</span><span class="sf8b2">reshape</span><span class="sf11b2">([-</span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">3</span><span class="sf11b2">, </span><span class="sf10b2">5</span><span class="sf11b2">])</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">bounds</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">poses_arr</span><span class="sf11b2">[:, -</span><span class="sf10b2">2</span><span class="sf11b2">:]</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">bounds</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">poses_arr</span><span class="sf11b2">[:, -</span><span class="sf10b2">2</span><span class="sf11b2">:]</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Pull out focal length before processing poses.</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Pull out focal length before processing poses.</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Correct rotation matrix ordering (and drop 5th column of poses).</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Correct rotation matrix ordering (and drop 5th column of poses).</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">fix_rotation</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">array</span><span class="sf11b2">([</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">fix_rotation</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">array</span><span class="sf11b2">([</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; [</span><span class="sf10b2">0</span><span class="sf11b2">, -</span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">],</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; [</span><span class="sf10b2">0</span><span class="sf11b2">, -</span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">],</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; [</span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">],</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; [</span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">],</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; [</span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">],</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; [</span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">],</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; [</span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">1</span><span class="sf11b2">],</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; [</span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">0</span><span class="sf11b2">, </span><span class="sf10b2">1</span><span class="sf11b2">],</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; ],</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; ],</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">dtype</span><span class="sf11b2">=</span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">float32</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">dtype</span><span class="sf11b2">=</span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">float32</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">inv_rotation</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">linalg</span><span class="sf11b2">.</span><span class="sf8b2">inv</span><span class="sf11b2">(</span><span class="sf3b2">fix_rotation</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">inv_rotation</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf3b2">linalg</span><span class="sf11b2">.</span><span class="sf8b2">inv</span><span class="sf11b2">(</span><span class="sf3b2">fix_rotation</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">poses_o</span><span class="sf11b2">[:, :</span><span class="sf10b2">3</span><span class="sf11b2">, :</span><span class="sf10b2">4</span><span class="sf11b2">] @ </span><span class="sf3b2">fix_rotation</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">poses_o</span><span class="sf11b2">[:, :</span><span class="sf10b2">3</span><span class="sf11b2">, :</span><span class="sf10b2">4</span><span class="sf11b2">] @ </span><span class="sf3b2">fix_rotation</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># for i in range(len(poses)):</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># for i in range(len(poses)):</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># &nbsp; &nbsp; poses[i][:3, :3] = poses[i][:3, :3].transpose()</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># &nbsp; &nbsp; poses[i][:3, :3] = poses[i][:3, :3].transpose()</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">pose_utils</span><span class="sf11b2">.</span><span class="sf8b2">recenter_poses</span><span class="sf11b2">(</span><span class="sf3b2">poses</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">pose_utils</span><span class="sf11b2">.</span><span class="sf8b2">recenter_poses</span><span class="sf11b2">(</span><span class="sf3b2">poses</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">s</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf21b2">max</span><span class="sf11b2">(</span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf21b2">abs</span><span class="sf11b2">(</span><span class="sf3b2">render_poses</span><span class="sf11b2">[:, :</span><span class="sf10b2">3</span><span class="sf11b2">, -</span><span class="sf10b2">1</span><span class="sf11b2">]))</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">s</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf21b2">max</span><span class="sf11b2">(</span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf21b2">abs</span><span class="sf11b2">(</span><span class="sf3b2">render_poses</span><span class="sf11b2">[:, :</span><span class="sf10b2">3</span><span class="sf11b2">, -</span><span class="sf10b2">1</span><span class="sf11b2">]))</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">[:, :</span><span class="sf10b2">3</span><span class="sf11b2">, -</span><span class="sf10b2">1</span><span class="sf11b2">] /= </span><span class="sf3b2">s</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">[:, :</span><span class="sf10b2">3</span><span class="sf11b2">, -</span><span class="sf10b2">1</span><span class="sf11b2">] /= </span><span class="sf3b2">s</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Separate out 360 versus forward facing scenes.</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># Separate out 360 versus forward facing scenes.</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">pose_utils</span><span class="sf11b2">.</span><span class="sf8b2">generate_spiral_path_dtu</span><span class="sf11b2">(</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">pose_utils</span><span class="sf11b2">.</span><span class="sf8b2">generate_spiral_path_dtu</span><span class="sf11b2">(</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">, </span><span class="sf3b2">n_frames</span><span class="sf11b2">=</span><span class="sf10b2">180</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">, </span><span class="sf3b2">n_frames</span><span class="sf11b2">=</span><span class="sf10b2">180</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">[:, :</span><span class="sf10b2">3</span><span class="sf11b2">, -</span><span class="sf10b2">1</span><span class="sf11b2">] *= </span><span class="sf3b2">s</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">[:, :</span><span class="sf10b2">3</span><span class="sf11b2">, -</span><span class="sf10b2">1</span><span class="sf11b2">] *= </span><span class="sf3b2">s</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">pose_utils</span><span class="sf11b2">.</span><span class="sf8b2">backcenter_poses</span><span class="sf11b2">(</span><span class="sf3b2">render_pose<wbr>s</span><span class="sf11b2">, </span><span class="sf3b2">poses</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">pose_utils</span><span class="sf11b2">.</span><span class="sf8b2">backcenter_poses</span><span class="sf11b2">(</span><span class="sf3b2">render_pose<wbr>s</span><span class="sf11b2">, </span><span class="sf3b2">poses</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># for i in range(len(render_poses)):</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># for i in range(len(render_poses)):</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># &nbsp; &nbsp; render_poses[i][:3, :3] = render_poses[i][:3, :3].transpose()</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># &nbsp; &nbsp; render_poses[i][:3, :3] = render_poses[i][:3, :3].transpose()</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;@ </span><span class="sf3b2">inv_rotation</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;@ </span><span class="sf3b2">inv_rotation</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">concatenate</span><span class="sf11b2">([</span><span class="sf3b2">render_poses</span><span class="sf11b2">, </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">tile</span><span class="sf11b2">(</span><span class="sf3b2">poses_o</span><span class="sf11b2">[:</span><span class="sf10b2">1</span><span class="sf11b2">, :</span><span class="sf10b2">3</span><span class="sf11b2">, </span><span class="sf10b2">4</span><span class="sf11b2">:], (</span><span class="sf3b2">render_poses</span><span class="sf11b2">.</span><span class="sf3b2">shape</span><span class="sf11b2">[</span><span class="sf10b2">0</span><span class="sf11b2">], </span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">1</span><span class="sf11b2">))], -</span><span class="sf10b2">1</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_poses</span><span class="sf11b2">&nbsp;= </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">concatenate</span><span class="sf11b2">([</span><span class="sf3b2">render_poses</span><span class="sf11b2">, </span><span class="sf3b2">np</span><span class="sf11b2">.</span><span class="sf8b2">tile</span><span class="sf11b2">(</span><span class="sf3b2">poses_o</span><span class="sf11b2">[:</span><span class="sf10b2">1</span><span class="sf11b2">, :</span><span class="sf10b2">3</span><span class="sf11b2">, </span><span class="sf10b2">4</span><span class="sf11b2">:], (</span><span class="sf3b2">render_poses</span><span class="sf11b2">.</span><span class="sf3b2">shape</span><span class="sf11b2">[</span><span class="sf10b2">0</span><span class="sf11b2">], </span><span class="sf10b2">1</span><span class="sf11b2">, </span><span class="sf10b2">1</span><span class="sf11b2">))], -</span><span class="sf10b2">1</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_cam_infos</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">generateLLFFCameras</span><span class="sf11b2">(</span><span class="sf3b2">render_poses</span><span class="sf11b2">.</span><span class="sf8b2">transp<wbr>ose</span><span class="sf11b2">([</span><span class="sf10b2">1</span><span class="sf11b2">,</span><span class="sf10b2">2</span><span class="sf11b2">,</span><span class="sf10b2">0</span><span class="sf11b2">]))</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">render_cam_infos</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">generateLLFFCameras</span><span class="sf11b2">(</span><span class="sf3b2">render_poses</span><span class="sf11b2">.</span><span class="sf8b2">transp<wbr>ose</span><span class="sf11b2">([</span><span class="sf10b2">1</span><span class="sf11b2">,</span><span class="sf10b2">2</span><span class="sf11b2">,</span><span class="sf10b2">0</span><span class="sf11b2">]))</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">getNerfppNorm</span><span class="sf11b2">(</span><span class="sf3b2">render_cam_infos</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">getNerfppNorm</span><span class="sf11b2">(</span><span class="sf3b2">render_cam_infos</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">scene_info</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">SceneInfo</span><span class="sf11b2">(</span><span class="sf3b2">point_cloud</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf3b2">scene_info</span><span class="sf11b2">&nbsp;= </span><span class="sf8b2">SceneInfo</span><span class="sf11b2">(</span><span class="sf3b2">point_cloud</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">train_cameras</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">train_cameras</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">test_cameras</span><span class="sf11b2">=</span><span class="sf3b2">render_cam_infos</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">test_cameras</span><span class="sf11b2">=</span><span class="sf3b2">render_cam_infos</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">eval_cameras</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">eval_cameras</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">=</span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">=</span><span class="sf3b2">nerf_normalization</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">ply_path</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">)</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="sf3b2">ply_path</span><span class="sf11b2">=</span><span class="sf20b2">None</span><span class="sf11b2">)</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">return</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">scene_info</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf7b2">return</span><span class="sf11b2">&nbsp;</span><span class="sf3b2">scene_info</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
<td class="ln"></td><td class="sf3b2"><code>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf3b2">sceneLoadTypeCallbacks</span><span class="sf11b2">&nbsp;= {</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf3b2">sceneLoadTypeCallbacks</span><span class="sf11b2">&nbsp;= {</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf12b2">"Colmap"</span><span class="sf11b2">: </span><span class="sf3b2">readColmapSceneInfo</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf12b2">"Colmap"</span><span class="sf11b2">: </span><span class="sf3b2">readColmapSceneInfo</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf12b2">"Blender"</span><span class="sf11b2">&nbsp;: </span><span class="sf3b2">readNerfSyntheticInfo</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf12b2">"Blender"</span><span class="sf11b2">&nbsp;: </span><span class="sf3b2">readNerfSyntheticInfo</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># "LLFF" : readLLFFInfo,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf9b2"># "LLFF" : readLLFFInfo,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf12b2">"Spiral"</span><span class="sf11b2">&nbsp;: </span><span class="sf3b2">CreateLLFFSpiral</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf12b2">"Spiral"</span><span class="sf11b2">&nbsp;: </span><span class="sf3b2">CreateLLFFSpiral</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf12b2">"SpiralDTU"</span><span class="sf11b2">&nbsp;: </span><span class="sf3b2">CreateDTUSpiral</span><span class="sf11b2">,</span></code></td>
<td class="ln"></td><td class="sf3b2"><code><span class="sf11b2">&nbsp; &nbsp; </span><span class="sf12b2">"SpiralDTU"</span><span class="sf11b2">&nbsp;: </span><span class="sf3b2">CreateDTUSpiral</span><span class="sf11b2">,</span></code></td>
</tr>
<tr>
<td class="ln"><a id="d7" href="#d7">.</a></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; ">}</span></code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code><span style="color: #000000; background-color: #efcb05; ">}</span>&nbsp;</code></td>
</tr>
<tr>
<td class="ln"></td><td style="color: #000000; background-color: #c0c0c0; "><code>&nbsp;</code></td>
<td class="ln"></td><td style="color: #000000; background-color: #efcb05; "><code>&nbsp;</code></td>
</tr>
</tbody>
</table>
</body>
</html>
